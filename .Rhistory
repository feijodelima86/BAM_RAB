ALL.SUM<-ALL.SUM %>% reduce(full_join)
ALL.SUM[is.na(ALL.SUM)] <- 0
L=nrow(ALL.SUM)
j=2
dat1 <- lapply(1:L,function(x){
res <- list(xx=c(ALL.SUM[x,1]+j, ALL.SUM[x,1]-j, ALL.SUM[x,1]-j, ALL.SUM[x,1]+j),
yy=c(ALL.SUM[x,5], ALL.SUM[x,5], ALL.SUM[x,8], ALL.SUM[x,8]))
return(res)
})
dat2 <- lapply(1:L,function(x){
res <- list(xx=c(ALL.SUM[x,1]+j, ALL.SUM[x,1]-j, ALL.SUM[x,1]-j, ALL.SUM[x,1]+j),
yy=c(ALL.SUM[x,5], ALL.SUM[x,5], ALL.SUM[x,6]+ALL.SUM[x,8], ALL.SUM[x,6]+ALL.SUM[x,8]))
return(res)
})
dat3 <- lapply(1:L,function(x){
res <- list(xx=c(ALL.SUM[x,1]+j, ALL.SUM[x,1]-j, ALL.SUM[x,1]-j, ALL.SUM[x,1]+j),
yy=c(ALL.SUM[x,5], ALL.SUM[x,5], ALL.SUM[x,3]+ALL.SUM[x,6]+ALL.SUM[x,8], ALL.SUM[x,3]+ALL.SUM[x,6]+ALL.SUM[x,8]))
return(res)
})
ardat1 <- lapply(1:L,function(x){
res <- list(x0=c(ALL.SUM[x,1], ALL.SUM[x,1]),
y0=c(ALL.SUM[x,8]),
x1=c(ALL.SUM[x,1], ALL.SUM[x,1]),
y1=c(ALL.SUM[x,8]+ALL.SUM[x,9]))
return(res)
})
ardat2 <- lapply(1:L,function(x){
res <- list(x0=c(ALL.SUM[x,1], ALL.SUM[x,1]),
y0=c(ALL.SUM[x,6]+ ALL.SUM[x,8]),
x1=c(ALL.SUM[x,1], ALL.SUM[x,1]),
y1=c(ALL.SUM[x,6]+ALL.SUM[x,8]+ALL.SUM[x,7]))
return(res)
})
ardat3 <- lapply(1:L,function(x){
res <- list(x0=c(ALL.SUM[x,1], ALL.SUM[x,1]),
y0=c(ALL.SUM[x,6]+ALL.SUM[x,8]+ALL.SUM[x,3]),
x1=c(ALL.SUM[x,1], ALL.SUM[x,1]),
y1=c(ALL.SUM[x,6]+ALL.SUM[x,8]+ALL.SUM[x,3]+ALL.SUM[x,4]))
return(res)
})
#dev.new(width=10, height=7, noRStudioGD = TRUE)
par(mar=c(4,6,4,4))
plot(ALL.SUM[,1], ALL.SUM[,5],
type='n',
ylim=c(0, plyr::round_any(max(ALL.SUM[3]+ALL.SUM[6]+ALL.SUM[8]+ALL.SUM[4]), 40, f = ceiling)),
xlim= c(as.Date("2021-06-20"),as.Date("2021-10-30")),
ylab=NA,
yaxt = "n",
cex=1.5,
xaxt = "n",
xlab = NA,
cex.lab=1, cex.axis=1.2, cex.main=1.2, cex.sub=1.2,
)
axis(side = 2, las=1, font.axis=2, cex.axis=2)
at = seq(0, plyr::round_any(max(ALL.SUM[3]+ALL.SUM[6]+ALL.SUM[8]), 175, f = ceiling), length.out=5)
axis.Date(1, at=seq(as.Date("2021-06-20"), as.Date("2021-10-30"), "2 weeks"), las=1, font.axis=2, cex.axis=2, format="%d-%b")
for (i in 1:L) polygon(unlist(dat3[[i]]$xx),unlist(dat3[[i]]$yy),col="gold", border="black")
for (i in 1:L) polygon(unlist(dat2[[i]]$xx),unlist(dat2[[i]]$yy),col="chartreuse3", border="black")
for (i in 1:L) polygon(unlist(dat1[[i]]$xx),unlist(dat1[[i]]$yy),col=colors()[89],border="black")
warnings()
for (i in 1:L) arrows(unlist(ardat3[[i]]$x0),unlist(ardat3[[i]]$y0),unlist(ardat3[[i]]$x1),unlist(ardat3[[i]]$y1), length=0.075, angle=90, code=2, lwd=2,col="black")
for (i in 1:L) arrows(unlist(ardat2[[i]]$x0),unlist(ardat2[[i]]$y0),unlist(ardat2[[i]]$x1),unlist(ardat2[[i]]$y1), length=0.075, angle=90, code=2, lwd=2,col="black")
for (i in 1:L) arrows(unlist(ardat1[[i]]$x0),unlist(ardat1[[i]]$y0),unlist(ardat1[[i]]$x1),unlist(ardat1[[i]]$y1), length=0.075, angle=90, code=2, lwd=2,col="black")
box(lwd=4)
options("warn"=1)
names(alldata)
n1<-70
mult=1
EPIL.SUM<-data.frame(aggregate(as.numeric(dfEPIL[,n1]) ~ SAMPLING_DATE+SITE, dfEPIL, mean))
EPIL.SUM[,4]<-aggregate(as.numeric(dfEPIL[,n1]) ~ SAMPLING_DATE+SITE, dfEPIL, se)[,3]
EPIL.SUM <- subset(EPIL.SUM, SITE == ssite)
names(EPIL.SUM)<-c("DATE","SITE","MEAN.EPIL","STDER.EPIL")
EPIL.SUM[,5]<--2
EPIL.SUM[,c(3,4)]<-EPIL.SUM[,c(3,4)]*mult
FILA.SUM<-data.frame(aggregate(as.numeric(dfFILA[,n1]) ~ SAMPLING_DATE+SITE, dfFILA, mean))
FILA.SUM[,4]<-aggregate(as.numeric(dfFILA[,n1]) ~ SAMPLING_DATE+SITE, dfFILA, se)[,3]
FILA.SUM <- subset(FILA.SUM, SITE == ssite)
names(FILA.SUM)<-c("DATE","SITE","MEAN.FILA","STDER.FILA")
FILA.SUM[,5]<--2
FILA.SUM[,c(3,4)]<-FILA.SUM[,c(3,4)]*mult
EPIP.SUM<-data.frame(aggregate(as.numeric(dfEPIP[,n1]) ~ SAMPLING_DATE+SITE, dfEPIP, mean))
EPIP.SUM[,4]<-aggregate(as.numeric(dfEPIP[,n1]) ~ SAMPLING_DATE+SITE, dfEPIP, se)[,3]
EPIP.SUM <- subset(EPIP.SUM, SITE == ssite)
names(EPIP.SUM)<-c("DATE","SITE","MEAN.EPIP","STDER.EPIP")
EPIP.SUM[,5]<--2
EPIP.SUM[,c(3,4)]<-EPIP.SUM[,c(3,4)]*mult
ALL.SUM<-list(EPIP.SUM,FILA.SUM,EPIL.SUM)
ALL.SUM<-ALL.SUM %>% reduce(full_join)
ALL.SUM[is.na(ALL.SUM)] <- 0
L=nrow(ALL.SUM)
j=2
dat1 <- lapply(1:L,function(x){
res <- list(xx=c(ALL.SUM[x,1]+j, ALL.SUM[x,1]-j, ALL.SUM[x,1]-j, ALL.SUM[x,1]+j),
yy=c(ALL.SUM[x,5], ALL.SUM[x,5], ALL.SUM[x,8], ALL.SUM[x,8]))
return(res)
})
dat2 <- lapply(1:L,function(x){
res <- list(xx=c(ALL.SUM[x,1]+j, ALL.SUM[x,1]-j, ALL.SUM[x,1]-j, ALL.SUM[x,1]+j),
yy=c(ALL.SUM[x,5], ALL.SUM[x,5], ALL.SUM[x,6]+ALL.SUM[x,8], ALL.SUM[x,6]+ALL.SUM[x,8]))
return(res)
})
dat3 <- lapply(1:L,function(x){
res <- list(xx=c(ALL.SUM[x,1]+j, ALL.SUM[x,1]-j, ALL.SUM[x,1]-j, ALL.SUM[x,1]+j),
yy=c(ALL.SUM[x,5], ALL.SUM[x,5], ALL.SUM[x,3]+ALL.SUM[x,6]+ALL.SUM[x,8], ALL.SUM[x,3]+ALL.SUM[x,6]+ALL.SUM[x,8]))
return(res)
})
ardat1 <- lapply(1:L,function(x){
res <- list(x0=c(ALL.SUM[x,1], ALL.SUM[x,1]),
y0=c(ALL.SUM[x,8]),
x1=c(ALL.SUM[x,1], ALL.SUM[x,1]),
y1=c(ALL.SUM[x,8]+ALL.SUM[x,9]))
return(res)
})
ardat2 <- lapply(1:L,function(x){
res <- list(x0=c(ALL.SUM[x,1], ALL.SUM[x,1]),
y0=c(ALL.SUM[x,6]+ ALL.SUM[x,8]),
x1=c(ALL.SUM[x,1], ALL.SUM[x,1]),
y1=c(ALL.SUM[x,6]+ALL.SUM[x,8]+ALL.SUM[x,7]))
return(res)
})
ardat3 <- lapply(1:L,function(x){
res <- list(x0=c(ALL.SUM[x,1], ALL.SUM[x,1]),
y0=c(ALL.SUM[x,6]+ALL.SUM[x,8]+ALL.SUM[x,3]),
x1=c(ALL.SUM[x,1], ALL.SUM[x,1]),
y1=c(ALL.SUM[x,6]+ALL.SUM[x,8]+ALL.SUM[x,3]+ALL.SUM[x,4]))
return(res)
})
#dev.new(width=10, height=7, noRStudioGD = TRUE)
par(mar=c(4,6,4,4))
plot(ALL.SUM[,1], ALL.SUM[,5],
type='n',
ylim=c(0, plyr::round_any(max(ALL.SUM[3]+ALL.SUM[6]+ALL.SUM[8]+ALL.SUM[4]), 40, f = ceiling)),
xlim= c(as.Date("2021-06-20"),as.Date("2021-10-30")),
ylab=NA,
yaxt = "n",
cex=1.5,
xaxt = "n",
xlab = NA,
cex.lab=1, cex.axis=1.2, cex.main=1.2, cex.sub=1.2,
)
axis(side = 2, las=1, font.axis=2, cex.axis=2)
at = seq(0, plyr::round_any(max(ALL.SUM[3]+ALL.SUM[6]+ALL.SUM[8]), 175, f = ceiling), length.out=5)
axis.Date(1, at=seq(as.Date("2021-06-20"), as.Date("2021-10-30"), "2 weeks"), las=1, font.axis=2, cex.axis=2, format="%d-%b")
for (i in 1:L) polygon(unlist(dat3[[i]]$xx),unlist(dat3[[i]]$yy),col="gold", border="black")
for (i in 1:L) polygon(unlist(dat2[[i]]$xx),unlist(dat2[[i]]$yy),col="chartreuse3", border="black")
for (i in 1:L) polygon(unlist(dat1[[i]]$xx),unlist(dat1[[i]]$yy),col=colors()[89],border="black")
warnings()
for (i in 1:L) arrows(unlist(ardat3[[i]]$x0),unlist(ardat3[[i]]$y0),unlist(ardat3[[i]]$x1),unlist(ardat3[[i]]$y1), length=0.075, angle=90, code=2, lwd=2,col="black")
for (i in 1:L) arrows(unlist(ardat2[[i]]$x0),unlist(ardat2[[i]]$y0),unlist(ardat2[[i]]$x1),unlist(ardat2[[i]]$y1), length=0.075, angle=90, code=2, lwd=2,col="black")
for (i in 1:L) arrows(unlist(ardat1[[i]]$x0),unlist(ardat1[[i]]$y0),unlist(ardat1[[i]]$x1),unlist(ardat1[[i]]$y1), length=0.075, angle=90, code=2, lwd=2,col="black")
box(lwd=4)
options("warn"=1)
plot(ALL.SUM[,1], ALL.SUM[,5],
type='n',
ylim=c(0, plyr::round_any(max(ALL.SUM[3]+ALL.SUM[6]+ALL.SUM[8]+ALL.SUM[4]), 0.1, f = ceiling)),
xlim= c(as.Date("2021-06-20"),as.Date("2021-10-30")),
ylab=NA,
yaxt = "n",
cex=1.5,
xaxt = "n",
xlab = NA,
cex.lab=1, cex.axis=1.2, cex.main=1.2, cex.sub=1.2,
)
axis(side = 2, las=1, font.axis=2, cex.axis=2)
at = seq(0, plyr::round_any(max(ALL.SUM[3]+ALL.SUM[6]+ALL.SUM[8]), 175, f = ceiling), length.out=5)
axis.Date(1, at=seq(as.Date("2021-06-20"), as.Date("2021-10-30"), "2 weeks"), las=1, font.axis=2, cex.axis=2, format="%d-%b")
for (i in 1:L) polygon(unlist(dat3[[i]]$xx),unlist(dat3[[i]]$yy),col="gold", border="black")
for (i in 1:L) polygon(unlist(dat2[[i]]$xx),unlist(dat2[[i]]$yy),col="chartreuse3", border="black")
for (i in 1:L) polygon(unlist(dat1[[i]]$xx),unlist(dat1[[i]]$yy),col=colors()[89],border="black")
warnings()
for (i in 1:L) arrows(unlist(ardat3[[i]]$x0),unlist(ardat3[[i]]$y0),unlist(ardat3[[i]]$x1),unlist(ardat3[[i]]$y1), length=0.075, angle=90, code=2, lwd=2,col="black")
for (i in 1:L) arrows(unlist(ardat2[[i]]$x0),unlist(ardat2[[i]]$y0),unlist(ardat2[[i]]$x1),unlist(ardat2[[i]]$y1), length=0.075, angle=90, code=2, lwd=2,col="black")
for (i in 1:L) arrows(unlist(ardat1[[i]]$x0),unlist(ardat1[[i]]$y0),unlist(ardat1[[i]]$x1),unlist(ardat1[[i]]$y1), length=0.075, angle=90, code=2, lwd=2,col="black")
box(lwd=4)
options("warn"=1)
n1<-61
mult=1
EPIL.SUM<-data.frame(aggregate(as.numeric(dfEPIL[,n1]) ~ SAMPLING_DATE+SITE, dfEPIL, mean))
EPIL.SUM[,4]<-aggregate(as.numeric(dfEPIL[,n1]) ~ SAMPLING_DATE+SITE, dfEPIL, se)[,3]
EPIL.SUM <- subset(EPIL.SUM, SITE == ssite)
names(EPIL.SUM)<-c("DATE","SITE","MEAN.EPIL","STDER.EPIL")
EPIL.SUM[,5]<--2
EPIL.SUM[,c(3,4)]<-EPIL.SUM[,c(3,4)]*mult
FILA.SUM<-data.frame(aggregate(as.numeric(dfFILA[,n1]) ~ SAMPLING_DATE+SITE, dfFILA, mean))
FILA.SUM[,4]<-aggregate(as.numeric(dfFILA[,n1]) ~ SAMPLING_DATE+SITE, dfFILA, se)[,3]
FILA.SUM <- subset(FILA.SUM, SITE == ssite)
names(FILA.SUM)<-c("DATE","SITE","MEAN.FILA","STDER.FILA")
FILA.SUM[,5]<--2
FILA.SUM[,c(3,4)]<-FILA.SUM[,c(3,4)]*mult
EPIP.SUM<-data.frame(aggregate(as.numeric(dfEPIP[,n1]) ~ SAMPLING_DATE+SITE, dfEPIP, mean))
EPIP.SUM[,4]<-aggregate(as.numeric(dfEPIP[,n1]) ~ SAMPLING_DATE+SITE, dfEPIP, se)[,3]
EPIP.SUM <- subset(EPIP.SUM, SITE == ssite)
names(EPIP.SUM)<-c("DATE","SITE","MEAN.EPIP","STDER.EPIP")
EPIP.SUM[,5]<--2
EPIP.SUM[,c(3,4)]<-EPIP.SUM[,c(3,4)]*mult
ALL.SUM<-list(EPIP.SUM,FILA.SUM,EPIL.SUM)
ALL.SUM<-ALL.SUM %>% reduce(full_join)
ALL.SUM[is.na(ALL.SUM)] <- 0
L=nrow(ALL.SUM)
j=2
dat1 <- lapply(1:L,function(x){
res <- list(xx=c(ALL.SUM[x,1]+j, ALL.SUM[x,1]-j, ALL.SUM[x,1]-j, ALL.SUM[x,1]+j),
yy=c(ALL.SUM[x,5], ALL.SUM[x,5], ALL.SUM[x,8], ALL.SUM[x,8]))
return(res)
})
dat2 <- lapply(1:L,function(x){
res <- list(xx=c(ALL.SUM[x,1]+j, ALL.SUM[x,1]-j, ALL.SUM[x,1]-j, ALL.SUM[x,1]+j),
yy=c(ALL.SUM[x,5], ALL.SUM[x,5], ALL.SUM[x,6]+ALL.SUM[x,8], ALL.SUM[x,6]+ALL.SUM[x,8]))
return(res)
})
dat3 <- lapply(1:L,function(x){
res <- list(xx=c(ALL.SUM[x,1]+j, ALL.SUM[x,1]-j, ALL.SUM[x,1]-j, ALL.SUM[x,1]+j),
yy=c(ALL.SUM[x,5], ALL.SUM[x,5], ALL.SUM[x,3]+ALL.SUM[x,6]+ALL.SUM[x,8], ALL.SUM[x,3]+ALL.SUM[x,6]+ALL.SUM[x,8]))
return(res)
})
ardat1 <- lapply(1:L,function(x){
res <- list(x0=c(ALL.SUM[x,1], ALL.SUM[x,1]),
y0=c(ALL.SUM[x,8]),
x1=c(ALL.SUM[x,1], ALL.SUM[x,1]),
y1=c(ALL.SUM[x,8]+ALL.SUM[x,9]))
return(res)
})
ardat2 <- lapply(1:L,function(x){
res <- list(x0=c(ALL.SUM[x,1], ALL.SUM[x,1]),
y0=c(ALL.SUM[x,6]+ ALL.SUM[x,8]),
x1=c(ALL.SUM[x,1], ALL.SUM[x,1]),
y1=c(ALL.SUM[x,6]+ALL.SUM[x,8]+ALL.SUM[x,7]))
return(res)
})
ardat3 <- lapply(1:L,function(x){
res <- list(x0=c(ALL.SUM[x,1], ALL.SUM[x,1]),
y0=c(ALL.SUM[x,6]+ALL.SUM[x,8]+ALL.SUM[x,3]),
x1=c(ALL.SUM[x,1], ALL.SUM[x,1]),
y1=c(ALL.SUM[x,6]+ALL.SUM[x,8]+ALL.SUM[x,3]+ALL.SUM[x,4]))
return(res)
})
#dev.new(width=10, height=7, noRStudioGD = TRUE)
par(mar=c(4,6,4,4))
plot(ALL.SUM[,1], ALL.SUM[,5],
type='n',
ylim=c(0, plyr::round_any(max(ALL.SUM[3]+ALL.SUM[6]+ALL.SUM[8]+ALL.SUM[4]), 0.1, f = ceiling)),
xlim= c(as.Date("2021-06-20"),as.Date("2021-10-30")),
ylab=NA,
yaxt = "n",
cex=1.5,
xaxt = "n",
xlab = NA,
cex.lab=1, cex.axis=1.2, cex.main=1.2, cex.sub=1.2,
)
axis(side = 2, las=1, font.axis=2, cex.axis=2)
at = seq(0, plyr::round_any(max(ALL.SUM[3]+ALL.SUM[6]+ALL.SUM[8]), 175, f = ceiling), length.out=5)
axis.Date(1, at=seq(as.Date("2021-06-20"), as.Date("2021-10-30"), "2 weeks"), las=1, font.axis=2, cex.axis=2, format="%d-%b")
for (i in 1:L) polygon(unlist(dat3[[i]]$xx),unlist(dat3[[i]]$yy),col="gold", border="black")
for (i in 1:L) polygon(unlist(dat2[[i]]$xx),unlist(dat2[[i]]$yy),col="chartreuse3", border="black")
for (i in 1:L) polygon(unlist(dat1[[i]]$xx),unlist(dat1[[i]]$yy),col=colors()[89],border="black")
warnings()
for (i in 1:L) arrows(unlist(ardat3[[i]]$x0),unlist(ardat3[[i]]$y0),unlist(ardat3[[i]]$x1),unlist(ardat3[[i]]$y1), length=0.075, angle=90, code=2, lwd=2,col="black")
for (i in 1:L) arrows(unlist(ardat2[[i]]$x0),unlist(ardat2[[i]]$y0),unlist(ardat2[[i]]$x1),unlist(ardat2[[i]]$y1), length=0.075, angle=90, code=2, lwd=2,col="black")
for (i in 1:L) arrows(unlist(ardat1[[i]]$x0),unlist(ardat1[[i]]$y0),unlist(ardat1[[i]]$x1),unlist(ardat1[[i]]$y1), length=0.075, angle=90, code=2, lwd=2,col="black")
box(lwd=4)
options("warn"=1)
ALL.SUM$MEAN.EPIP<-   ALL.SUM$MEAN.EPIP  *0.35
ALL.SUM$STDER.EPIP<-  ALL.SUM$STDER.EPIP *0.35
ALL.SUM$MEAN.EPIL<-   ALL.SUM$MEAN.EPIL  *0.35
ALL.SUM$STDER.EPIL<-  ALL.SUM$STDER.EPIL *0.35
ALL.SUM$MEAN.FILA<-   ALL.SUM$MEAN.FILA  *0.09
ALL.SUM$STDER.FILA<-  ALL.SUM$STDER.FILA *0.09
ALL.SUM[is.na(ALL.SUM)] <- 0
L=nrow(ALL.SUM)
j=2
dat1 <- lapply(1:L,function(x){
res <- list(xx=c(ALL.SUM[x,1]+j, ALL.SUM[x,1]-j, ALL.SUM[x,1]-j, ALL.SUM[x,1]+j),
yy=c(ALL.SUM[x,5], ALL.SUM[x,5], ALL.SUM[x,8], ALL.SUM[x,8]))
return(res)
})
dat2 <- lapply(1:L,function(x){
res <- list(xx=c(ALL.SUM[x,1]+j, ALL.SUM[x,1]-j, ALL.SUM[x,1]-j, ALL.SUM[x,1]+j),
yy=c(ALL.SUM[x,5], ALL.SUM[x,5], ALL.SUM[x,6]+ALL.SUM[x,8], ALL.SUM[x,6]+ALL.SUM[x,8]))
return(res)
})
dat3 <- lapply(1:L,function(x){
res <- list(xx=c(ALL.SUM[x,1]+j, ALL.SUM[x,1]-j, ALL.SUM[x,1]-j, ALL.SUM[x,1]+j),
yy=c(ALL.SUM[x,5], ALL.SUM[x,5], ALL.SUM[x,3]+ALL.SUM[x,6]+ALL.SUM[x,8], ALL.SUM[x,3]+ALL.SUM[x,6]+ALL.SUM[x,8]))
return(res)
})
ardat1 <- lapply(1:L,function(x){
res <- list(x0=c(ALL.SUM[x,1], ALL.SUM[x,1]),
y0=c(ALL.SUM[x,8]),
x1=c(ALL.SUM[x,1], ALL.SUM[x,1]),
y1=c(ALL.SUM[x,8]+ALL.SUM[x,9]))
return(res)
})
ardat2 <- lapply(1:L,function(x){
res <- list(x0=c(ALL.SUM[x,1], ALL.SUM[x,1]),
y0=c(ALL.SUM[x,6]+ ALL.SUM[x,8]),
x1=c(ALL.SUM[x,1], ALL.SUM[x,1]),
y1=c(ALL.SUM[x,6]+ALL.SUM[x,8]+ALL.SUM[x,7]))
return(res)
})
ardat3 <- lapply(1:L,function(x){
res <- list(x0=c(ALL.SUM[x,1], ALL.SUM[x,1]),
y0=c(ALL.SUM[x,6]+ALL.SUM[x,8]+ALL.SUM[x,3]),
x1=c(ALL.SUM[x,1], ALL.SUM[x,1]),
y1=c(ALL.SUM[x,6]+ALL.SUM[x,8]+ALL.SUM[x,3]+ALL.SUM[x,4]))
return(res)
})
#dev.new(width=10, height=7, noRStudioGD = TRUE)
par(mar=c(4,6,4,4))
plot(ALL.SUM[,1], ALL.SUM[,5],
type='n',
ylim=c(0, plyr::round_any(max(ALL.SUM[3]+ALL.SUM[6]+ALL.SUM[8]+ALL.SUM[4]), 0.1, f = ceiling)),
xlim= c(as.Date("2021-06-20"),as.Date("2021-10-30")),
ylab=NA,
yaxt = "n",
cex=1.5,
xaxt = "n",
xlab = NA,
cex.lab=1, cex.axis=1.2, cex.main=1.2, cex.sub=1.2,
)
axis(side = 2, las=1, font.axis=2, cex.axis=2)
at = seq(0, plyr::round_any(max(ALL.SUM[3]+ALL.SUM[6]+ALL.SUM[8]), 175, f = ceiling), length.out=5)
axis.Date(1, at=seq(as.Date("2021-06-20"), as.Date("2021-10-30"), "2 weeks"), las=1, font.axis=2, cex.axis=2, format="%d-%b")
for (i in 1:L) polygon(unlist(dat3[[i]]$xx),unlist(dat3[[i]]$yy),col="gold", border="black")
for (i in 1:L) polygon(unlist(dat2[[i]]$xx),unlist(dat2[[i]]$yy),col="chartreuse3", border="black")
for (i in 1:L) polygon(unlist(dat1[[i]]$xx),unlist(dat1[[i]]$yy),col=colors()[89],border="black")
warnings()
for (i in 1:L) arrows(unlist(ardat3[[i]]$x0),unlist(ardat3[[i]]$y0),unlist(ardat3[[i]]$x1),unlist(ardat3[[i]]$y1), length=0.075, angle=90, code=2, lwd=2,col="black")
for (i in 1:L) arrows(unlist(ardat2[[i]]$x0),unlist(ardat2[[i]]$y0),unlist(ardat2[[i]]$x1),unlist(ardat2[[i]]$y1), length=0.075, angle=90, code=2, lwd=2,col="black")
for (i in 1:L) arrows(unlist(ardat1[[i]]$x0),unlist(ardat1[[i]]$y0),unlist(ardat1[[i]]$x1),unlist(ardat1[[i]]$y1), length=0.075, angle=90, code=2, lwd=2,col="black")
box(lwd=4)
options("warn"=1)
names(COMPARTMENTS)
n1<-13
mult=1
j=2
TD.SUM<-data.frame(aggregate(as.numeric(COMPARTMENTS[,n1+20]) ~ SAMPLING_DATE+SITE, COMPARTMENTS, mean))
CL.SUM<-data.frame(aggregate(as.numeric(COMPARTMENTS[,n1+10]) ~ SAMPLING_DATE+SITE, COMPARTMENTS, mean))
SS.SUM<-data.frame(aggregate(as.numeric(COMPARTMENTS[,n1]) ~ SAMPLING_DATE+SITE, COMPARTMENTS, mean))
ALL.wSUM<-list(TD.SUM,CL.SUM,SS.SUM)
ALL.wSUM<-ALL.wSUM %>% reduce(full_join)
ALL.wSUM <- subset(ALL.wSUM, SITE == ssite)
names(ALL.wSUM)<-c("DATE","SITE","TD.SUM","CL.SUM","SS.SUM")
ALL.wSUM[is.na(ALL.wSUM)] <- 0
ALL.wSUM[,6]<--2
L=nrow(ALL.wSUM)
ALL.wSUM$DATE<-as.Date(ALL.wSUM$DATE, format = "%m/%d/%Y")
dat1 <- lapply(1:L,function(x){
res <- list(xx=c(ALL.wSUM[x,1]+j, ALL.wSUM[x,1]-j, ALL.wSUM[x,1]-j, ALL.wSUM[x,1]+j),
yy=c(ALL.wSUM[x,6], ALL.wSUM[x,6], ALL.wSUM[x,3], ALL.wSUM[x,3]))
return(res)
})
dat2 <- lapply(1:L,function(x){
res <- list(xx=c(ALL.wSUM[x,1]+j, ALL.wSUM[x,1]-j, ALL.wSUM[x,1]-j, ALL.wSUM[x,1]+j),
yy=c(ALL.wSUM[x,6], ALL.wSUM[x,6], ALL.wSUM[x,3]+ALL.wSUM[x,4], ALL.wSUM[x,3]+ALL.wSUM[x,4]))
return(res)
})
dat3 <- lapply(1:L,function(x){
res <- list(xx=c(ALL.wSUM[x,1]+j, ALL.wSUM[x,1]-j, ALL.wSUM[x,1]-j, ALL.wSUM[x,1]+j),
yy=c(ALL.wSUM[x,6], ALL.wSUM[x,6], ALL.wSUM[x,3]+ALL.wSUM[x,4]+ALL.wSUM[x,5], ALL.wSUM[x,3]+ALL.wSUM[x,4]+ALL.wSUM[x,5]))
return(res)
})
#dev.new(width=12, height=6, noRStudioGD = TRUE)
par(mar=c(4,6,4,4))
plot(ALL.wSUM[,1], ALL.wSUM[,5],
type='n',
ylim=c(0, plyr::round_any(max(ALL.wSUM[,3]+ALL.wSUM[,4]+ALL.wSUM[,5]), 0.06, f = ceiling)),
xlim= c(as.Date("2021-06-20"),as.Date("2021-10-30")),
ylab=NA,
yaxt = "n",
cex=1.5,
xaxt = "n",
xlab = NA,
cex.lab=1, cex.axis=1.2, cex.main=1.2, cex.sub=1.2,
)
axis(side = 2, las=1, font.axis=2, cex.axis=2)
at = seq(0, plyr::round_any(max(ALL.wSUM[,3]+ALL.wSUM[,4]+ALL.wSUM[,5]), 175, f = ceiling), length.out=5)
axis.Date(1, at=seq(as.Date("2021-06-20"), as.Date("2021-10-30"), "2 weeks"), las=1, font.axis=2, cex.axis=2, format="%d-%b")
for (i in 1:L) polygon(unlist(dat3[[i]]$xx),unlist(dat3[[i]]$yy),col="tomato4", border="black")
for (i in 1:L) polygon(unlist(dat2[[i]]$xx),unlist(dat2[[i]]$yy),col="plum", border="black")
for (i in 1:L) polygon(unlist(dat1[[i]]$xx),unlist(dat1[[i]]$yy),col="turquoise3",border="black")
box(lwd=4)
ALL.wSUM
names(alldata)
names(COMPARTMENTS)
COMPARTMENTS <- read.csv("2_incremental/water5.csv")
colnames(COMPARTMENTS)[c(2:3)]<-c("SAMPLING_DATE","SITE")
COMPARTMENTS$SITE <- factor(COMPARTMENTS$SITE, labels = c("WS","DL","GR","GC","BG","BN"))
ssite<-"BG"
names(COMPARTMENTS)
n1<-13
mult=1
j=2
TD.SUM<-data.frame(aggregate(as.numeric(COMPARTMENTS[,n1+20]) ~ SAMPLING_DATE+SITE, COMPARTMENTS, mean))
CL.SUM<-data.frame(aggregate(as.numeric(COMPARTMENTS[,n1+10]) ~ SAMPLING_DATE+SITE, COMPARTMENTS, mean))
SS.SUM<-data.frame(aggregate(as.numeric(COMPARTMENTS[,n1]) ~ SAMPLING_DATE+SITE, COMPARTMENTS, mean))
ALL.wSUM<-list(TD.SUM,CL.SUM,SS.SUM)
ALL.wSUM<-ALL.wSUM %>% reduce(full_join)
ALL.wSUM <- subset(ALL.wSUM, SITE == ssite)
names(ALL.wSUM)<-c("DATE","SITE","TD.SUM","CL.SUM","SS.SUM")
ALL.wSUM[is.na(ALL.wSUM)] <- 0
ALL.wSUM[,6]<--2
L=nrow(ALL.wSUM)
ALL.wSUM$DATE<-as.Date(ALL.wSUM$DATE, format = "%m/%d/%Y")
dat1 <- lapply(1:L,function(x){
res <- list(xx=c(ALL.wSUM[x,1]+j, ALL.wSUM[x,1]-j, ALL.wSUM[x,1]-j, ALL.wSUM[x,1]+j),
yy=c(ALL.wSUM[x,6], ALL.wSUM[x,6], ALL.wSUM[x,3], ALL.wSUM[x,3]))
return(res)
})
dat2 <- lapply(1:L,function(x){
res <- list(xx=c(ALL.wSUM[x,1]+j, ALL.wSUM[x,1]-j, ALL.wSUM[x,1]-j, ALL.wSUM[x,1]+j),
yy=c(ALL.wSUM[x,6], ALL.wSUM[x,6], ALL.wSUM[x,3]+ALL.wSUM[x,4], ALL.wSUM[x,3]+ALL.wSUM[x,4]))
return(res)
})
dat3 <- lapply(1:L,function(x){
res <- list(xx=c(ALL.wSUM[x,1]+j, ALL.wSUM[x,1]-j, ALL.wSUM[x,1]-j, ALL.wSUM[x,1]+j),
yy=c(ALL.wSUM[x,6], ALL.wSUM[x,6], ALL.wSUM[x,3]+ALL.wSUM[x,4]+ALL.wSUM[x,5], ALL.wSUM[x,3]+ALL.wSUM[x,4]+ALL.wSUM[x,5]))
return(res)
})
#dev.new(width=12, height=6, noRStudioGD = TRUE)
par(mar=c(4,6,4,4))
plot(ALL.wSUM[,1], ALL.wSUM[,5],
type='n',
ylim=c(0, plyr::round_any(max(ALL.wSUM[,3]+ALL.wSUM[,4]+ALL.wSUM[,5]), 0.06, f = ceiling)),
xlim= c(as.Date("2021-06-20"),as.Date("2021-10-30")),
ylab=NA,
yaxt = "n",
cex=1.5,
xaxt = "n",
xlab = NA,
cex.lab=1, cex.axis=1.2, cex.main=1.2, cex.sub=1.2,
)
axis(side = 2, las=1, font.axis=2, cex.axis=2)
at = seq(0, plyr::round_any(max(ALL.wSUM[,3]+ALL.wSUM[,4]+ALL.wSUM[,5]), 175, f = ceiling), length.out=5)
axis.Date(1, at=seq(as.Date("2021-06-20"), as.Date("2021-10-30"), "2 weeks"), las=1, font.axis=2, cex.axis=2, format="%d-%b")
for (i in 1:L) polygon(unlist(dat3[[i]]$xx),unlist(dat3[[i]]$yy),col="tomato4", border="black")
for (i in 1:L) polygon(unlist(dat2[[i]]$xx),unlist(dat2[[i]]$yy),col="plum", border="black")
for (i in 1:L) polygon(unlist(dat1[[i]]$xx),unlist(dat1[[i]]$yy),col="turquoise3",border="black")
box(lwd=4)
COMPARTMENTS
n1<-13
mult=1
j=2
TD.SUM<-data.frame(aggregate(as.numeric(COMPARTMENTS[,n1+20]) ~ SAMPLING_DATE+SITE, COMPARTMENTS, mean))
CL.SUM<-data.frame(aggregate(as.numeric(COMPARTMENTS[,n1+10]) ~ SAMPLING_DATE+SITE, COMPARTMENTS, mean))
SS.SUM<-data.frame(aggregate(as.numeric(COMPARTMENTS[,n1]) ~ SAMPLING_DATE+SITE, COMPARTMENTS, mean))
ALL.wSUM<-list(TD.SUM,CL.SUM,SS.SUM)
ALL.wSUM<-ALL.wSUM %>% reduce(full_join)
ALL.wSUM <- subset(ALL.wSUM, SITE == ssite)
names(ALL.wSUM)<-c("DATE","SITE","TD.SUM","CL.SUM","SS.SUM")
ALL.wSUM[is.na(ALL.wSUM)] <- 0
ALL.wSUM[,6]<--2
L=nrow(ALL.wSUM)
ALL.wSUM$DATE<-as.Date(ALL.wSUM$DATE, format = "%m/%d/%Y")
dat1 <- lapply(1:L,function(x){
res <- list(xx=c(ALL.wSUM[x,1]+j, ALL.wSUM[x,1]-j, ALL.wSUM[x,1]-j, ALL.wSUM[x,1]+j),
yy=c(ALL.wSUM[x,6], ALL.wSUM[x,6], ALL.wSUM[x,3], ALL.wSUM[x,3]))
return(res)
})
dat2 <- lapply(1:L,function(x){
res <- list(xx=c(ALL.wSUM[x,1]+j, ALL.wSUM[x,1]-j, ALL.wSUM[x,1]-j, ALL.wSUM[x,1]+j),
yy=c(ALL.wSUM[x,6], ALL.wSUM[x,6], ALL.wSUM[x,3]+ALL.wSUM[x,4], ALL.wSUM[x,3]+ALL.wSUM[x,4]))
return(res)
})
n1<-12
mult=1
j=2
TD.SUM<-data.frame(aggregate(as.numeric(COMPARTMENTS[,n1+20]) ~ SAMPLING_DATE+SITE, COMPARTMENTS, mean))
CL.SUM<-data.frame(aggregate(as.numeric(COMPARTMENTS[,n1+10]) ~ SAMPLING_DATE+SITE, COMPARTMENTS, mean))
SS.SUM<-data.frame(aggregate(as.numeric(COMPARTMENTS[,n1]) ~ SAMPLING_DATE+SITE, COMPARTMENTS, mean))
ALL.wSUM<-list(TD.SUM,CL.SUM,SS.SUM)
ALL.wSUM<-ALL.wSUM %>% reduce(full_join)
ALL.wSUM <- subset(ALL.wSUM, SITE == ssite)
names(ALL.wSUM)<-c("DATE","SITE","TD.SUM","CL.SUM","SS.SUM")
ALL.wSUM[is.na(ALL.wSUM)] <- 0
ALL.wSUM[,6]<--2
L=nrow(ALL.wSUM)
ALL.wSUM$DATE<-as.Date(ALL.wSUM$DATE, format = "%m/%d/%Y")
dat1 <- lapply(1:L,function(x){
res <- list(xx=c(ALL.wSUM[x,1]+j, ALL.wSUM[x,1]-j, ALL.wSUM[x,1]-j, ALL.wSUM[x,1]+j),
yy=c(ALL.wSUM[x,6], ALL.wSUM[x,6], ALL.wSUM[x,3], ALL.wSUM[x,3]))
return(res)
})
dat2 <- lapply(1:L,function(x){
res <- list(xx=c(ALL.wSUM[x,1]+j, ALL.wSUM[x,1]-j, ALL.wSUM[x,1]-j, ALL.wSUM[x,1]+j),
yy=c(ALL.wSUM[x,6], ALL.wSUM[x,6], ALL.wSUM[x,3]+ALL.wSUM[x,4], ALL.wSUM[x,3]+ALL.wSUM[x,4]))
return(res)
})
dat3 <- lapply(1:L,function(x){
res <- list(xx=c(ALL.wSUM[x,1]+j, ALL.wSUM[x,1]-j, ALL.wSUM[x,1]-j, ALL.wSUM[x,1]+j),
yy=c(ALL.wSUM[x,6], ALL.wSUM[x,6], ALL.wSUM[x,3]+ALL.wSUM[x,4]+ALL.wSUM[x,5], ALL.wSUM[x,3]+ALL.wSUM[x,4]+ALL.wSUM[x,5]))
return(res)
})
#dev.new(width=12, height=6, noRStudioGD = TRUE)
par(mar=c(4,6,4,4))
plot(ALL.wSUM[,1], ALL.wSUM[,5],
type='n',
ylim=c(0, plyr::round_any(max(ALL.wSUM[,3]+ALL.wSUM[,4]+ALL.wSUM[,5]), 0.06, f = ceiling)),
xlim= c(as.Date("2021-06-20"),as.Date("2021-10-30")),
ylab=NA,
yaxt = "n",
cex=1.5,
xaxt = "n",
xlab = NA,
cex.lab=1, cex.axis=1.2, cex.main=1.2, cex.sub=1.2,
)
axis(side = 2, las=1, font.axis=2, cex.axis=2)
at = seq(0, plyr::round_any(max(ALL.wSUM[,3]+ALL.wSUM[,4]+ALL.wSUM[,5]), 175, f = ceiling), length.out=5)
axis.Date(1, at=seq(as.Date("2021-06-20"), as.Date("2021-10-30"), "2 weeks"), las=1, font.axis=2, cex.axis=2, format="%d-%b")
for (i in 1:L) polygon(unlist(dat3[[i]]$xx),unlist(dat3[[i]]$yy),col="tomato4", border="black")
for (i in 1:L) polygon(unlist(dat2[[i]]$xx),unlist(dat2[[i]]$yy),col="plum", border="black")
for (i in 1:L) polygon(unlist(dat1[[i]]$xx),unlist(dat1[[i]]$yy),col="turquoise3",border="black")
box(lwd=4)
