sd <- my.prc$sdev
correlations <- t(t(my.prc$rotation)*sd)
summary(my.prc)
plot	(my.prc$x,
pch=c(0,1,2)[as.numeric(factor(COMPARTMENTS$SAMPLE_DESCRIPTOR))],
xlim=c(-max(abs(range(my.prc$x[,1]))),max(abs(range(my.prc$x[,1])))),
ylim=c(-max(abs(range(my.prc$x[,2]))),max(abs(range(my.prc$x[,2])))),
cex.lab=1.2, cex.axis=1.1, cex.main=1.4, cex.sub=1.4,
col=colors
)
par(new=TRUE)
plot	(correlations[1,],
correlations[2,],
col="White",
xlim=c(-1,1),
ylim=c(-1,1),
xaxt="n",
yaxt="n",
xlab="",
ylab="")
arrows(0, 0,
x1 = correlations[,1],
y1 = correlations[,2],
length = 0.1, angle = 30, lwd =2.0,
code = 2, col = par("fg"),
lty = par("lty"))
text(	x=correlations[,1]*1.05,
y=correlations[,2]*1.05,
labels = names(PCA.DF),
cex=0.7)
rownames(my.prc$rotation)
names(PCA.DF)<- c("Be","Ca","Co","Mo","Pb","S","Se","Si","Sn")
cor(PCA.DF)
corrplot(cor(PCA.DF), method = "circle", lwd=2)
names(COMPARTMENTS)
colors <- c("blue", "darkgreen", "red")
colors <- colors[as.numeric(factor(na.omit(COMPARTMENTS$SAMPLE_DESCRIPTOR)))]
mydata <- PCA.DF
my.scaled.data <- as.matrix(scale(mydata, center = TRUE, scale = TRUE))
my.prc <- prcomp(na.omit(my.scaled.data), center = TRUE, scale = TRUE)
wa<-data.frame(my.prc$x[,1],my.prc$x[,2])
plot(my.prc)
sd <- my.prc$sdev
correlations <- t(t(my.prc$rotation)*sd)
wa<-data.frame(colors,my.prc$x[,1],my.prc$x[,2])
colors
my.prc$x[,1]
my.scaled.data
nrow(my.scaled.data)
my.scaled.data
nrow(my.scaled.data)
my.scaled.data
view(my.scaled.data)
nrow(my.scaled.data)
my.scaled.data
nrow(my.scaled.data)
length(my.scaled.data)
nrow
nrow(my.scaled.data)
ncol(my.scaled.data)
alldata <- data.frame(read_csv("2_incremental/20220420_STANDING_CROP.csv"))
alldata$SAMPLING_DATE<-as.Date(alldata$SAMPLING_DATE, format = "%m/%d/%Y")
names(alldata)
COMPARTMENTS <- alldata[which(alldata$SAMPLE_DESCRIPTOR == "EPIL"| alldata$SAMPLE_DESCRIPTOR == "EPIP" | alldata$SAMPLE_DESCRIPTOR == "FILA"),]
nrow(COMPARTMENTS)
PCA.DF<-as.data.frame(na.omit(COMPARTMENTS[,c(17,18,20,31,35,36,40,41,44)]))
PCA.DF<-log(PCA.DF)
nrow(PCA.DF)
PCA.DF
PCA.DF<-as.data.frame(na.omit(COMPARTMENTS[,c(17,18,20,31,35,36,40,41,44)]))
nrow(PCA.DF)
PCA.DF<-log(PCA.DF)
nrow(PCA.DF)
names(PCA.DF)<- c("Be","Ca","Co","Mo","Pb","S","Se","Si","Sn")
library(installr)
updateR()
library(tidyverse)
library(readr)
library(plyr)
library(dplyr)
alldata <- data.frame(read_csv("2_incremental/20220420_STANDING_CROP_Rafa_Interpolation_Dont_Use.csv"))
alldata$SAMPLING_DATE<-as.Date(alldata$SAMPLING_DATE, format = "%m/%d/%Y")
se <- function(x, ...) sqrt(var(x, ...)/length(x))
#alldata[,c(11-87)]<-alldata[,c(13-87)]
#alldata<-replace(alldata[c(13:88)], alldata[c(13:87)] < 0, 0)
# Variable date to factor
dfEPIL <- alldata[which(alldata$SAMPLE_DESCRIPTOR == "EPIL"),]
dfEPIP <- alldata[which(alldata$SAMPLE_DESCRIPTOR == "EPIP"),]
dfFILA <- alldata[which(alldata$SAMPLE_DESCRIPTOR == "FILA"),]
#Selected site
ssite<-"GC"
# Selected element
names(alldata)
n1<-87
mult=1
EPIL.SUM<-data.frame(aggregate(as.numeric(dfEPIL[,n1]) ~ SAMPLING_DATE+SITE, dfEPIL, mean))
EPIL.SUM[,4]<-aggregate(as.numeric(dfEPIL[,n1]) ~ SAMPLING_DATE+SITE, dfEPIL, se)[,3]
EPIL.SUM <- subset(EPIL.SUM, SITE == ssite)
names(EPIL.SUM)<-c("DATE","SITE","MEAN.EPIL","STDER.EPIL")
EPIL.SUM[,5]<--2
EPIL.SUM[,c(3,4)]<-EPIL.SUM[,c(3,4)]*mult
FILA.SUM<-data.frame(aggregate(as.numeric(dfFILA[,n1]) ~ SAMPLING_DATE+SITE, dfFILA, mean))
FILA.SUM[,4]<-aggregate(as.numeric(dfFILA[,n1]) ~ SAMPLING_DATE+SITE, dfFILA, se)[,3]
FILA.SUM <- subset(FILA.SUM, SITE == ssite)
names(FILA.SUM)<-c("DATE","SITE","MEAN.FILA","STDER.FILA")
FILA.SUM[,5]<--2
FILA.SUM[,c(3,4)]<-FILA.SUM[,c(3,4)]*mult
EPIP.SUM<-data.frame(aggregate(as.numeric(dfEPIP[,n1]) ~ SAMPLING_DATE+SITE, dfEPIP, mean))
EPIP.SUM[,4]<-aggregate(as.numeric(dfEPIP[,n1]) ~ SAMPLING_DATE+SITE, dfEPIP, se)[,3]
EPIP.SUM <- subset(EPIP.SUM, SITE == ssite)
names(EPIP.SUM)<-c("DATE","SITE","MEAN.EPIP","STDER.EPIP")
EPIP.SUM[,5]<--2
EPIP.SUM[,c(3,4)]<-EPIP.SUM[,c(3,4)]*mult
ALL.SUM<-list(EPIP.SUM,FILA.SUM,EPIL.SUM)
ALL.SUM<-ALL.SUM %>% reduce(full_join)
ALL.SUM[is.na(ALL.SUM)] <- 0
L=nrow(ALL.SUM)
#Column Width
j=2
#each 'polygon' is inside a list with xx and yy coordinates
dat1 <- lapply(1:L,function(x){
res <- list(xx=c(ALL.SUM[x,1]+j, ALL.SUM[x,1]-j, ALL.SUM[x,1]-j, ALL.SUM[x,1]+j),
yy=c(ALL.SUM[x,5], ALL.SUM[x,5], ALL.SUM[x,8], ALL.SUM[x,8]))
return(res)
})
dat2 <- lapply(1:L,function(x){
res <- list(xx=c(ALL.SUM[x,1]+j, ALL.SUM[x,1]-j, ALL.SUM[x,1]-j, ALL.SUM[x,1]+j),
yy=c(ALL.SUM[x,5], ALL.SUM[x,5], ALL.SUM[x,6]+ALL.SUM[x,8], ALL.SUM[x,6]+ALL.SUM[x,8]))
return(res)
})
dat3 <- lapply(1:L,function(x){
res <- list(xx=c(ALL.SUM[x,1]+j, ALL.SUM[x,1]-j, ALL.SUM[x,1]-j, ALL.SUM[x,1]+j),
yy=c(ALL.SUM[x,5], ALL.SUM[x,5], ALL.SUM[x,3]+ALL.SUM[x,6]+ALL.SUM[x,8], ALL.SUM[x,3]+ALL.SUM[x,6]+ALL.SUM[x,8]))
return(res)
})
ardat1 <- lapply(1:L,function(x){
res <- list(x0=c(ALL.SUM[x,1], ALL.SUM[x,1]),
y0=c(ALL.SUM[x,8]),
x1=c(ALL.SUM[x,1], ALL.SUM[x,1]),
y1=c(ALL.SUM[x,8]+ALL.SUM[x,9]))
return(res)
})
ardat2 <- lapply(1:L,function(x){
res <- list(x0=c(ALL.SUM[x,1], ALL.SUM[x,1]),
y0=c(ALL.SUM[x,6]+ ALL.SUM[x,8]),
x1=c(ALL.SUM[x,1], ALL.SUM[x,1]),
y1=c(ALL.SUM[x,6]+ALL.SUM[x,8]+ALL.SUM[x,7]))
return(res)
})
ardat3 <- lapply(1:L,function(x){
res <- list(x0=c(ALL.SUM[x,1], ALL.SUM[x,1]),
y0=c(ALL.SUM[x,6]+ALL.SUM[x,8]+ALL.SUM[x,3]),
x1=c(ALL.SUM[x,1], ALL.SUM[x,1]),
y1=c(ALL.SUM[x,6]+ALL.SUM[x,8]+ALL.SUM[x,3]+ALL.SUM[x,4]))
return(res)
})
#create empty plot
#dev.new(width=10, height=7, noRStudioGD = TRUE)
plot(ALL.SUM[,1], ALL.SUM[,5],
type='n',
ylim=c(20, plyr::round_any(max(ALL.SUM[3]+ALL.SUM[6]+ALL.SUM[8]+ALL.SUM[4]), 100, f = ceiling)),
xlim= c(as.Date("2021-06-20"),as.Date("2021-10-30")),
ylab=NA,
yaxt = "n",
cex=1.5,
xaxt = "n",
xlab = NA,
cex.lab=1, cex.axis=1.2, cex.main=1.2, cex.sub=1.2,
)
axis(side = 2, las=1, font.axis=1, cex.axis=1.5)
plyr::round_any(range(ALL.SUM[3]+ALL.SUM[6]+ALL.SUM[8]), 10, f = ceiling)
at = seq(0, plyr::round_any(max(ALL.SUM[3]+ALL.SUM[6]+ALL.SUM[8]), 175, f = ceiling), length.out=5)
axis.Date(1, at=seq(as.Date("2021-06-20"), as.Date("2021-10-30"), "1 week"), las=1, font.axis=2, cex.axis=1.5, format="%d-%b")
#add polygons
for (i in 1:L) polygon(unlist(dat3[[i]]$xx),unlist(dat3[[i]]$yy),col="gold", border="black")
for (i in 1:L) polygon(unlist(dat2[[i]]$xx),unlist(dat2[[i]]$yy),col="chartreuse3", border="black")
for (i in 1:L) polygon(unlist(dat1[[i]]$xx),unlist(dat1[[i]]$yy),col=colors()[89],border="black")
warnings()
for (i in 1:L) arrows(unlist(ardat3[[i]]$x0),unlist(ardat3[[i]]$y0),unlist(ardat3[[i]]$x1),unlist(ardat3[[i]]$y1), length=0.075, angle=90, code=2, lwd=2,col="black")
for (i in 1:L) arrows(unlist(ardat2[[i]]$x0),unlist(ardat2[[i]]$y0),unlist(ardat2[[i]]$x1),unlist(ardat2[[i]]$y1), length=0.075, angle=90, code=2, lwd=2,col="black")
for (i in 1:L) arrows(unlist(ardat1[[i]]$x0),unlist(ardat1[[i]]$y0),unlist(ardat1[[i]]$x1),unlist(ardat1[[i]]$y1), length=0.075, angle=90, code=2, lwd=2,col="black")
box(lwd=4)
options("warn"=1)
alldata <- data.frame(read_csv("2_incremental/20220420_STANDING_CROP_Rafa_Interpolation_Dont_Use.csv"))
alldata$SAMPLING_DATE<-as.Date(alldata$SAMPLING_DATE, format = "%m/%d/%Y")
se <- function(x, ...) sqrt(var(x, ...)/length(x))
dfEPIL <- alldata[which(alldata$SAMPLE_DESCRIPTOR == "EPIL"),]
dfEPIP <- alldata[which(alldata$SAMPLE_DESCRIPTOR == "EPIP"),]
dfFILA <- alldata[which(alldata$SAMPLE_DESCRIPTOR == "FILA"),]
ssite<-"GC"
names(alldata)
n1<-87
mult=1
EPIL.SUM<-data.frame(aggregate(as.numeric(dfEPIL[,n1]) ~ SAMPLING_DATE+SITE, dfEPIL, mean))
EPIL.SUM[,4]<-aggregate(as.numeric(dfEPIL[,n1]) ~ SAMPLING_DATE+SITE, dfEPIL, se)[,3]
EPIL.SUM <- subset(EPIL.SUM, SITE == ssite)
names(EPIL.SUM)<-c("DATE","SITE","MEAN.EPIL","STDER.EPIL")
EPIL.SUM[,5]<--2
EPIL.SUM[,c(3,4)]<-EPIL.SUM[,c(3,4)]*mult
FILA.SUM<-data.frame(aggregate(as.numeric(dfFILA[,n1]) ~ SAMPLING_DATE+SITE, dfFILA, mean))
FILA.SUM[,4]<-aggregate(as.numeric(dfFILA[,n1]) ~ SAMPLING_DATE+SITE, dfFILA, se)[,3]
FILA.SUM <- subset(FILA.SUM, SITE == ssite)
names(FILA.SUM)<-c("DATE","SITE","MEAN.FILA","STDER.FILA")
FILA.SUM[,5]<--2
FILA.SUM[,c(3,4)]<-FILA.SUM[,c(3,4)]*mult
EPIP.SUM<-data.frame(aggregate(as.numeric(dfEPIP[,n1]) ~ SAMPLING_DATE+SITE, dfEPIP, mean))
EPIP.SUM[,4]<-aggregate(as.numeric(dfEPIP[,n1]) ~ SAMPLING_DATE+SITE, dfEPIP, se)[,3]
EPIP.SUM <- subset(EPIP.SUM, SITE == ssite)
names(EPIP.SUM)<-c("DATE","SITE","MEAN.EPIP","STDER.EPIP")
EPIP.SUM[,5]<--2
EPIP.SUM[,c(3,4)]<-EPIP.SUM[,c(3,4)]*mult
library("corrplot")                               # Load corrplot
library(tidyverse)
library(readr)
library(plyr)
library(dplyr)
alldata <- data.frame(read_csv("2_incremental/20220420_STANDING_CROP.csv"))
alldata$SAMPLING_DATE<-as.Date(alldata$SAMPLING_DATE, format = "%m/%d/%Y")
names(alldata)
#Big 5
COR.DF<-as.data.frame(na.omit(alldata[,c(13,19,22,25,35,49)]))
names(COR.DF)<- c("As","Cd","Cu","Fe","Pb","Zn")
cor(COR.DF)
corrplot(cor(COR.DF), method = "circle", lwd=2)
#Alldata
EPIL.COR.DF2 <- alldata[which(alldata$SAMPLE_DESCRIPTOR == "EPIL"),]
EPIP.COR.DF2 <- alldata[which(alldata$SAMPLE_DESCRIPTOR == "EPIP"),]
FILA.COR.DF2 <- alldata[which(alldata$SAMPLE_DESCRIPTOR == "FILA"),]
EPIL.COR.DF2<-as.data.frame(na.omit(EPIL.COR.DF2[,c(13:49)]))
EPIP.COR.DF2<-as.data.frame(na.omit(EPIP.COR.DF2[,c(13:49)]))
FILA.COR.DF2<-as.data.frame(na.omit(FILA.COR.DF2[,c(13:49)]))
#dev.new()
corrplot(cor(FILA.COR.DF2), method = "circle", lwd=2)
#Selected
EPIL.COR.DF3 <- alldata[which(alldata$SAMPLE_DESCRIPTOR == "EPIL"),]
EPIP.COR.DF3 <- alldata[which(alldata$SAMPLE_DESCRIPTOR == "EPIP"),]
FILA.COR.DF3 <- alldata[which(alldata$SAMPLE_DESCRIPTOR == "FILA"),]
c(17,18,20,31,35,36,40,41,44)+39
(13,19,22,25,35,40,49)+39
(13,19,22,25,35,40,49)+39
(13,19,22,25,35,40,49)+39)
c(13,19,22,25,35,40,49)+39
library("corrplot")                               # Load corrplot
library(tidyverse)
library(readr)
library(plyr)
library(dplyr)
alldata <- data.frame(read_csv("2_incremental/20220420_STANDING_CROP.csv"))
alldata$SAMPLING_DATE<-as.Date(alldata$SAMPLING_DATE, format = "%m/%d/%Y")
names(alldata)
#Big 5
COR.DF<-as.data.frame(na.omit(alldata[,c(13,19,22,25,35,49)]))
names(COR.DF)<- c("As","Cd","Cu","Fe","Pb","Zn")
cor(COR.DF)
corrplot(cor(COR.DF), method = "circle", lwd=2)
#Alldata
EPIL.COR.DF2 <- alldata[which(alldata$SAMPLE_DESCRIPTOR == "EPIL"),]
EPIP.COR.DF2 <- alldata[which(alldata$SAMPLE_DESCRIPTOR == "EPIP"),]
FILA.COR.DF2 <- alldata[which(alldata$SAMPLE_DESCRIPTOR == "FILA"),]
EPIL.COR.DF2<-as.data.frame(na.omit(EPIL.COR.DF2[,c(13:49)]))
EPIP.COR.DF2<-as.data.frame(na.omit(EPIP.COR.DF2[,c(13:49)]))
FILA.COR.DF2<-as.data.frame(na.omit(FILA.COR.DF2[,c(13:49)]))
#dev.new()
corrplot(cor(FILA.COR.DF2), method = "circle", lwd=2)
#Selected
EPIL.COR.DF3 <- alldata[which(alldata$SAMPLE_DESCRIPTOR == "EPIL"),]
EPIP.COR.DF3 <- alldata[which(alldata$SAMPLE_DESCRIPTOR == "EPIP"),]
FILA.COR.DF3 <- alldata[which(alldata$SAMPLE_DESCRIPTOR == "FILA"),]
#EPIL.COR.DF3<-as.data.frame(na.omit(EPIL.COR.DF3[,c(13,16,17,18,19,20,21,22,23,26,31,35,36,40,41,44,46,47,48)]))
#EPIP.COR.DF3<-as.data.frame(na.omit(EPIP.COR.DF3[,c(13,16,17,18,19,20,21,22,23,26,31,35,36,40,41,44,46,47,48)]))
#FILA.COR.DF3<-as.data.frame(na.omit(FILA.COR.DF3[,c(13,16,17,18,19,20,21,22,23,26,31,35,36,40,41,44,46,47,48)]))
EPIL.COR.DF3<-as.data.frame(na.omit(EPIL.COR.DF3[,c(52,58,61,64,74,79,88)]))
EPIP.COR.DF3<-as.data.frame(na.omit(EPIP.COR.DF3[,c(52,58,61,64,74,79,88)]))
FILA.COR.DF3<-as.data.frame(na.omit(FILA.COR.DF3[,c(52,58,61,64,74,79,88)]))
par(mfrow = c(1,3), mar = c(2, 4, 4, 2))
EPIL.TEST<-cor.mtest(EPIL.COR.DF3)
corrplot(cor(EPIL.COR.DF3), method = "circle", lwd=2, tl.cex = 2, cl.cex=2, cex.main=3, sig.level = 0.05, insig = "blank",
mar=c(0,0,0,0), title="\n\n Epilithon", diag=FALSE, order = "hclust", type="upper")
corrplot(cor(EPIP.COR.DF3), method = "circle", lwd=2, tl.cex = 2, cl.cex=2, cex.main=3, sig.level = 0.05, insig = "blank",
mar=c(0,0,0,0), title="\n\n Epiphytes", diag=FALSE, order = "hclust", type="upper")
corrplot(cor(FILA.COR.DF3), method = "circle", lwd=2, tl.cex = 2, cl.cex=2, cex.main=3, sig.level = 0.05, insig = "blank",
mar=c(0,0,0,0), title="\n\n Filamentous", diag=FALSE, order = "hclust", type="upper")
cor(EPIL.COR.DF3)
cor(EPIP.COR.DF3)
cor(FILA.COR.DF3)
###########GEARING UP FOR MULTIVARIATE ANALYSIS###################
###Testing compartment datasets for variance inflation factor.
library(usdm)
max.VIF<-10
EPIL.RED<-data.frame(EPIL.COR.DF3)
VIF.EPIL<-vif(EPIL.RED)
repeat {
if (max(VIF.EPIL[,2])>max.VIF) {
VIF.EPIL<-vif(EPIL.RED)
EPIL.RED <- within(EPIL.RED, rm(list=VIF.EPIL[which.max(VIF.EPIL[,2]),1]))
} else {
break
}
}
EPIP.RED<-data.frame(EPIP.COR.DF3)
VIF.EPIP<-vif(EPIP.RED)
repeat {
if (max(VIF.EPIP[,2])>max.VIF) {
VIF.EPIP<-vif(EPIP.RED)
EPIP.RED <- within(EPIP.RED, rm(list=VIF.EPIP[which.max(VIF.EPIP[,2]),1]))
} else {
break
}
}
FILA.RED<-data.frame(FILA.COR.DF3)
VIF.FILA<-vif(FILA.RED)
repeat {
if (max(VIF.FILA[,2])>max.VIF) {
VIF.FILA<-vif(FILA.RED)
FILA.RED <- within(FILA.RED, rm(list=VIF.FILA[which.max(VIF.FILA[,2]),1]))
} else {
break
}
}
ALL.COR.DF2<-as.data.frame(na.omit(alldata[,c(13:49)]))
#Selected
ALL.COR.DF3<-as.data.frame(na.omit(alldata[,c(13,16,17,18,19,20,21,22,23,26,31,35,36,40,41,44,46,47,48)]))
ALL.RED<-data.frame(ALL.COR.DF3)
VIF.ALL<-vif(ALL.RED)
repeat {
if (max(VIF.ALL[,2])>max.VIF) {
VIF.ALL<-vif(ALL.RED)
ALL.RED <- within(ALL.RED, rm(list=VIF.ALL[which.max(VIF.ALL[,2]),1]))
} else {
break
}
}
library("corrplot")                               # Load corrplot
library(tidyverse)
library(readr)
library(plyr)
library(dplyr)
alldata <- data.frame(read_csv("2_incremental/20220420_STANDING_CROP.csv"))
alldata$SAMPLING_DATE<-as.Date(alldata$SAMPLING_DATE, format = "%m/%d/%Y")
names(alldata)
#Big 5
COR.DF<-as.data.frame(na.omit(alldata[,c(13,19,22,25,35,49)]))
names(COR.DF)<- c("As","Cd","Cu","Fe","Pb","Zn")
cor(COR.DF)
corrplot(cor(COR.DF), method = "circle", lwd=2)
#Alldata
EPIL.COR.DF2 <- alldata[which(alldata$SAMPLE_DESCRIPTOR == "EPIL"),]
EPIP.COR.DF2 <- alldata[which(alldata$SAMPLE_DESCRIPTOR == "EPIP"),]
FILA.COR.DF2 <- alldata[which(alldata$SAMPLE_DESCRIPTOR == "FILA"),]
EPIL.COR.DF2<-as.data.frame(na.omit(EPIL.COR.DF2[,c(13:49)]))
EPIP.COR.DF2<-as.data.frame(na.omit(EPIP.COR.DF2[,c(13:49)]))
FILA.COR.DF2<-as.data.frame(na.omit(FILA.COR.DF2[,c(13:49)]))
#dev.new()
corrplot(cor(FILA.COR.DF2), method = "circle", lwd=2)
#Selected
EPIL.COR.DF3 <- alldata[which(alldata$SAMPLE_DESCRIPTOR == "EPIL"),]
EPIP.COR.DF3 <- alldata[which(alldata$SAMPLE_DESCRIPTOR == "EPIP"),]
FILA.COR.DF3 <- alldata[which(alldata$SAMPLE_DESCRIPTOR == "FILA"),]
#EPIL.COR.DF3<-as.data.frame(na.omit(EPIL.COR.DF3[,c(13,16,17,18,19,20,21,22,23,26,31,35,36,40,41,44,46,47,48)]))
#EPIP.COR.DF3<-as.data.frame(na.omit(EPIP.COR.DF3[,c(13,16,17,18,19,20,21,22,23,26,31,35,36,40,41,44,46,47,48)]))
#FILA.COR.DF3<-as.data.frame(na.omit(FILA.COR.DF3[,c(13,16,17,18,19,20,21,22,23,26,31,35,36,40,41,44,46,47,48)]))
EPIL.COR.DF3<-as.data.frame(na.omit(EPIL.COR.DF3[,c(52,58,61,64,74,79,88)]))
EPIP.COR.DF3<-as.data.frame(na.omit(EPIP.COR.DF3[,c(52,58,61,64,74,79,88)]))
FILA.COR.DF3<-as.data.frame(na.omit(FILA.COR.DF3[,c(52,58,61,64,74,79,88)]))
par(mfrow = c(1,3), mar = c(2, 4, 4, 2))
EPIL.TEST<-cor.mtest(EPIL.COR.DF3)
corrplot(cor(EPIL.COR.DF3), method = "circle", lwd=2, tl.cex = 2, cl.cex=2, cex.main=3, sig.level = 0.05, insig = "blank",
mar=c(0,0,0,0), title="\n\n Epilithon", diag=FALSE, order = "hclust", type="upper")
corrplot(cor(EPIP.COR.DF3), method = "circle", lwd=2, tl.cex = 2, cl.cex=2, cex.main=3, sig.level = 0.05, insig = "blank",
mar=c(0,0,0,0), title="\n\n Epiphytes", diag=FALSE, order = "hclust", type="upper")
corrplot(cor(FILA.COR.DF3), method = "circle", lwd=2, tl.cex = 2, cl.cex=2, cex.main=3, sig.level = 0.05, insig = "blank",
mar=c(0,0,0,0), title="\n\n Filamentous", diag=FALSE, order = "hclust", type="upper")
cor(EPIL.COR.DF3)
cor(EPIP.COR.DF3)
cor(FILA.COR.DF3)
###########GEARING UP FOR MULTIVARIATE ANALYSIS###################
###Testing compartment datasets for variance inflation factor.
library(usdm)
max.VIF<-10
EPIL.RED<-data.frame(EPIL.COR.DF3)
VIF.EPIL<-vif(EPIL.RED)
repeat {
if (max(VIF.EPIL[,2])>max.VIF) {
VIF.EPIL<-vif(EPIL.RED)
EPIL.RED <- within(EPIL.RED, rm(list=VIF.EPIL[which.max(VIF.EPIL[,2]),1]))
} else {
break
}
}
EPIP.RED<-data.frame(EPIP.COR.DF3)
VIF.EPIP<-vif(EPIP.RED)
repeat {
if (max(VIF.EPIP[,2])>max.VIF) {
VIF.EPIP<-vif(EPIP.RED)
EPIP.RED <- within(EPIP.RED, rm(list=VIF.EPIP[which.max(VIF.EPIP[,2]),1]))
} else {
break
}
}
FILA.RED<-data.frame(FILA.COR.DF3)
VIF.FILA<-vif(FILA.RED)
repeat {
if (max(VIF.FILA[,2])>max.VIF) {
VIF.FILA<-vif(FILA.RED)
FILA.RED <- within(FILA.RED, rm(list=VIF.FILA[which.max(VIF.FILA[,2]),1]))
} else {
break
}
}
ALL.COR.DF2<-as.data.frame(na.omit(alldata[,c(13:49)]))
#Selected
ALL.COR.DF3<-as.data.frame(na.omit(alldata[,c(13,16,17,18,19,20,21,22,23,26,31,35,36,40,41,44,46,47,48)]))
ALL.RED<-data.frame(ALL.COR.DF3)
VIF.ALL<-vif(ALL.RED)
repeat {
if (max(VIF.ALL[,2])>max.VIF) {
VIF.ALL<-vif(ALL.RED)
ALL.RED <- within(ALL.RED, rm(list=VIF.ALL[which.max(VIF.ALL[,2]),1]))
} else {
break
}
}
library("corrplot")                               # Load corrplot
library(tidyverse)
library(readr)
library(plyr)
library(dplyr)
alldata <- data.frame(read_csv("2_incremental/20220420_STANDING_CROP.csv"))
alldata$SAMPLING_DATE<-as.Date(alldata$SAMPLING_DATE, format = "%m/%d/%Y")
names(alldata)
#Big 5
COR.DF<-as.data.frame(na.omit(alldata[,c(13,19,22,25,35,49)]))
names(COR.DF)<- c("As","Cd","Cu","Fe","Pb","Zn")
cor(COR.DF)
corrplot(cor(COR.DF), method = "circle", lwd=2)
#Alldata
EPIL.COR.DF2 <- alldata[which(alldata$SAMPLE_DESCRIPTOR == "EPIL"),]
EPIP.COR.DF2 <- alldata[which(alldata$SAMPLE_DESCRIPTOR == "EPIP"),]
FILA.COR.DF2 <- alldata[which(alldata$SAMPLE_DESCRIPTOR == "FILA"),]
EPIL.COR.DF2<-as.data.frame(na.omit(EPIL.COR.DF2[,c(13:49)]))
EPIP.COR.DF2<-as.data.frame(na.omit(EPIP.COR.DF2[,c(13:49)]))
FILA.COR.DF2<-as.data.frame(na.omit(FILA.COR.DF2[,c(13:49)]))
#dev.new()
corrplot(cor(FILA.COR.DF2), method = "circle", lwd=2)
#Selected
EPIL.COR.DF3 <- alldata[which(alldata$SAMPLE_DESCRIPTOR == "EPIL"),]
EPIP.COR.DF3 <- alldata[which(alldata$SAMPLE_DESCRIPTOR == "EPIP"),]
FILA.COR.DF3 <- alldata[which(alldata$SAMPLE_DESCRIPTOR == "FILA"),]
#EPIL.COR.DF3<-as.data.frame(na.omit(EPIL.COR.DF3[,c(13,16,17,18,19,20,21,22,23,26,31,35,36,40,41,44,46,47,48)]))
#EPIP.COR.DF3<-as.data.frame(na.omit(EPIP.COR.DF3[,c(13,16,17,18,19,20,21,22,23,26,31,35,36,40,41,44,46,47,48)]))
#FILA.COR.DF3<-as.data.frame(na.omit(FILA.COR.DF3[,c(13,16,17,18,19,20,21,22,23,26,31,35,36,40,41,44,46,47,48)]))
EPIL.COR.DF3<-as.data.frame(na.omit(EPIL.COR.DF3[,c(52,58,61,64,74,79,88)]))
EPIP.COR.DF3<-as.data.frame(na.omit(EPIP.COR.DF3[,c(52,58,61,64,74,79,88)]))
FILA.COR.DF3<-as.data.frame(na.omit(FILA.COR.DF3[,c(52,58,61,64,74,79,88)]))
par(mfrow = c(1,3), mar = c(2, 4, 4, 2))
EPIL.TEST<-cor.mtest(EPIL.COR.DF3)
corrplot(cor(EPIL.COR.DF3), method = "circle", lwd=2, tl.cex = 2, cl.cex=2, cex.main=3, sig.level = 0.05, insig = "blank",
mar=c(0,0,0,0), title="\n\n Epilithon", diag=FALSE, order = "hclust", type="upper")
corrplot(cor(EPIP.COR.DF3), method = "circle", lwd=2, tl.cex = 2, cl.cex=2, cex.main=3, sig.level = 0.05, insig = "blank",
mar=c(0,0,0,0), title="\n\n Epiphytes", diag=FALSE, order = "hclust", type="upper")
corrplot(cor(FILA.COR.DF3), method = "circle", lwd=2, tl.cex = 2, cl.cex=2, cex.main=3, sig.level = 0.05, insig = "blank",
mar=c(0,0,0,0), title="\n\n Filamentous", diag=FALSE, order = "hclust", type="upper")
cor(EPIL.COR.DF3)
cor(EPIP.COR.DF3)
cor(FILA.COR.DF3)
library("corrplot")                               # Load corrplot
library(tidyverse)
library(readr)
library(plyr)
library(dplyr)
alldata <- data.frame(read_csv("2_incremental/20220420_STANDING_CROP.csv"))
alldata$SAMPLING_DATE<-as.Date(alldata$SAMPLING_DATE, format = "%m/%d/%Y")
names(alldata)
#Big 5
COR.DF<-as.data.frame(na.omit(alldata[,c(13,19,22,25,35,49)]))
names(COR.DF)<- c("As","Cd","Cu","Fe","Pb","Zn")
cor(COR.DF)
corrplot(cor(COR.DF), method = "circle", lwd=2)
#Alldata
EPIL.COR.DF2 <- alldata[which(alldata$SAMPLE_DESCRIPTOR == "EPIL"),]
EPIP.COR.DF2 <- alldata[which(alldata$SAMPLE_DESCRIPTOR == "EPIP"),]
FILA.COR.DF2 <- alldata[which(alldata$SAMPLE_DESCRIPTOR == "FILA"),]
EPIL.COR.DF2<-as.data.frame(na.omit(EPIL.COR.DF2[,c(13:49)]))
EPIP.COR.DF2<-as.data.frame(na.omit(EPIP.COR.DF2[,c(13:49)]))
FILA.COR.DF2<-as.data.frame(na.omit(FILA.COR.DF2[,c(13:49)]))
#dev.new()
corrplot(cor(FILA.COR.DF2), method = "circle", lwd=2)
#Selected
EPIL.COR.DF3 <- alldata[which(alldata$SAMPLE_DESCRIPTOR == "EPIL"),]
EPIP.COR.DF3 <- alldata[which(alldata$SAMPLE_DESCRIPTOR == "EPIP"),]
FILA.COR.DF3 <- alldata[which(alldata$SAMPLE_DESCRIPTOR == "FILA"),]
#EPIL.COR.DF3<-as.data.frame(na.omit(EPIL.COR.DF3[,c(13,16,17,18,19,20,21,22,23,26,31,35,36,40,41,44,46,47,48)]))
#EPIP.COR.DF3<-as.data.frame(na.omit(EPIP.COR.DF3[,c(13,16,17,18,19,20,21,22,23,26,31,35,36,40,41,44,46,47,48)]))
#FILA.COR.DF3<-as.data.frame(na.omit(FILA.COR.DF3[,c(13,16,17,18,19,20,21,22,23,26,31,35,36,40,41,44,46,47,48)]))
EPIL.COR.DF3<-as.data.frame(na.omit(EPIL.COR.DF3[,c(52,58,61,64,74,79,88)]))
EPIP.COR.DF3<-as.data.frame(na.omit(EPIP.COR.DF3[,c(52,58,61,64,74,79,88)]))
FILA.COR.DF3<-as.data.frame(na.omit(FILA.COR.DF3[,c(52,58,61,64,74,79,88)]))
dev.new()
par(mfrow = c(1,3), mar = c(2, 4, 4, 2))
EPIL.TEST<-cor.mtest(EPIL.COR.DF3)
corrplot(cor(EPIL.COR.DF3), method = "circle", lwd=2, tl.cex = 2, cl.cex=2, cex.main=3, sig.level = 0.05, insig = "blank",
mar=c(0,0,0,0), title="\n\n Epilithon", diag=FALSE, order = "hclust", type="upper")
corrplot(cor(EPIP.COR.DF3), method = "circle", lwd=2, tl.cex = 2, cl.cex=2, cex.main=3, sig.level = 0.05, insig = "blank",
mar=c(0,0,0,0), title="\n\n Epiphytes", diag=FALSE, order = "hclust", type="upper")
corrplot(cor(FILA.COR.DF3), method = "circle", lwd=2, tl.cex = 2, cl.cex=2, cex.main=3, sig.level = 0.05, insig = "blank",
mar=c(0,0,0,0), title="\n\n Filamentous", diag=FALSE, order = "hclust", type="upper")
cor(EPIL.COR.DF3)
cor(EPIP.COR.DF3)
cor(FILA.COR.DF3)
library(tidyverse)
library(lme4)
These are the PCA results for contents using the BIG5+ elements. Variables have been logged, scaled and centered.
