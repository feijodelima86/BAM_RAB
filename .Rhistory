xlim= c(as.Date("2021-06-20"),as.Date("2021-10-30")),
ylab=NA,
yaxt = "n",
cex=1.5,
xaxt = "n",
xlab = NA,
cex.lab=1, cex.axis=1.2, cex.main=1.2, cex.sub=1.2,
)
axis(side = 2, las=1, font.axis=2, cex.axis=2)
at = seq(0, plyr::round_any(max(ALL.wSUM[,3]+ALL.wSUM[,4]+ALL.wSUM[,5]), 175, f = ceiling), length.out=5)
axis.Date(1, at=seq(as.Date("2021-06-20"), as.Date("2021-10-30"), "2 weeks"), las=1, font.axis=2, cex.axis=2, format="%d-%b")
for (i in 1:L) polygon(unlist(dat3[[i]]$xx),unlist(dat3[[i]]$yy),col="tomato4", border="black")
for (i in 1:L) polygon(unlist(dat2[[i]]$xx),unlist(dat2[[i]]$yy),col="plum", border="black")
for (i in 1:L) polygon(unlist(dat1[[i]]$xx),unlist(dat1[[i]]$yy),col="turquoise3",border="black")
box(lwd=4)
COMPARTMENTS
n1<-13
mult=1
j=2
TD.SUM<-data.frame(aggregate(as.numeric(COMPARTMENTS[,n1+20]) ~ SAMPLING_DATE+SITE, COMPARTMENTS, mean))
CL.SUM<-data.frame(aggregate(as.numeric(COMPARTMENTS[,n1+10]) ~ SAMPLING_DATE+SITE, COMPARTMENTS, mean))
SS.SUM<-data.frame(aggregate(as.numeric(COMPARTMENTS[,n1]) ~ SAMPLING_DATE+SITE, COMPARTMENTS, mean))
ALL.wSUM<-list(TD.SUM,CL.SUM,SS.SUM)
ALL.wSUM<-ALL.wSUM %>% reduce(full_join)
ALL.wSUM <- subset(ALL.wSUM, SITE == ssite)
names(ALL.wSUM)<-c("DATE","SITE","TD.SUM","CL.SUM","SS.SUM")
ALL.wSUM[is.na(ALL.wSUM)] <- 0
ALL.wSUM[,6]<--2
L=nrow(ALL.wSUM)
ALL.wSUM$DATE<-as.Date(ALL.wSUM$DATE, format = "%m/%d/%Y")
dat1 <- lapply(1:L,function(x){
res <- list(xx=c(ALL.wSUM[x,1]+j, ALL.wSUM[x,1]-j, ALL.wSUM[x,1]-j, ALL.wSUM[x,1]+j),
yy=c(ALL.wSUM[x,6], ALL.wSUM[x,6], ALL.wSUM[x,3], ALL.wSUM[x,3]))
return(res)
})
dat2 <- lapply(1:L,function(x){
res <- list(xx=c(ALL.wSUM[x,1]+j, ALL.wSUM[x,1]-j, ALL.wSUM[x,1]-j, ALL.wSUM[x,1]+j),
yy=c(ALL.wSUM[x,6], ALL.wSUM[x,6], ALL.wSUM[x,3]+ALL.wSUM[x,4], ALL.wSUM[x,3]+ALL.wSUM[x,4]))
return(res)
})
n1<-12
mult=1
j=2
TD.SUM<-data.frame(aggregate(as.numeric(COMPARTMENTS[,n1+20]) ~ SAMPLING_DATE+SITE, COMPARTMENTS, mean))
CL.SUM<-data.frame(aggregate(as.numeric(COMPARTMENTS[,n1+10]) ~ SAMPLING_DATE+SITE, COMPARTMENTS, mean))
SS.SUM<-data.frame(aggregate(as.numeric(COMPARTMENTS[,n1]) ~ SAMPLING_DATE+SITE, COMPARTMENTS, mean))
ALL.wSUM<-list(TD.SUM,CL.SUM,SS.SUM)
ALL.wSUM<-ALL.wSUM %>% reduce(full_join)
ALL.wSUM <- subset(ALL.wSUM, SITE == ssite)
names(ALL.wSUM)<-c("DATE","SITE","TD.SUM","CL.SUM","SS.SUM")
ALL.wSUM[is.na(ALL.wSUM)] <- 0
ALL.wSUM[,6]<--2
L=nrow(ALL.wSUM)
ALL.wSUM$DATE<-as.Date(ALL.wSUM$DATE, format = "%m/%d/%Y")
dat1 <- lapply(1:L,function(x){
res <- list(xx=c(ALL.wSUM[x,1]+j, ALL.wSUM[x,1]-j, ALL.wSUM[x,1]-j, ALL.wSUM[x,1]+j),
yy=c(ALL.wSUM[x,6], ALL.wSUM[x,6], ALL.wSUM[x,3], ALL.wSUM[x,3]))
return(res)
})
dat2 <- lapply(1:L,function(x){
res <- list(xx=c(ALL.wSUM[x,1]+j, ALL.wSUM[x,1]-j, ALL.wSUM[x,1]-j, ALL.wSUM[x,1]+j),
yy=c(ALL.wSUM[x,6], ALL.wSUM[x,6], ALL.wSUM[x,3]+ALL.wSUM[x,4], ALL.wSUM[x,3]+ALL.wSUM[x,4]))
return(res)
})
dat3 <- lapply(1:L,function(x){
res <- list(xx=c(ALL.wSUM[x,1]+j, ALL.wSUM[x,1]-j, ALL.wSUM[x,1]-j, ALL.wSUM[x,1]+j),
yy=c(ALL.wSUM[x,6], ALL.wSUM[x,6], ALL.wSUM[x,3]+ALL.wSUM[x,4]+ALL.wSUM[x,5], ALL.wSUM[x,3]+ALL.wSUM[x,4]+ALL.wSUM[x,5]))
return(res)
})
#dev.new(width=12, height=6, noRStudioGD = TRUE)
par(mar=c(4,6,4,4))
plot(ALL.wSUM[,1], ALL.wSUM[,5],
type='n',
ylim=c(0, plyr::round_any(max(ALL.wSUM[,3]+ALL.wSUM[,4]+ALL.wSUM[,5]), 0.06, f = ceiling)),
xlim= c(as.Date("2021-06-20"),as.Date("2021-10-30")),
ylab=NA,
yaxt = "n",
cex=1.5,
xaxt = "n",
xlab = NA,
cex.lab=1, cex.axis=1.2, cex.main=1.2, cex.sub=1.2,
)
axis(side = 2, las=1, font.axis=2, cex.axis=2)
at = seq(0, plyr::round_any(max(ALL.wSUM[,3]+ALL.wSUM[,4]+ALL.wSUM[,5]), 175, f = ceiling), length.out=5)
axis.Date(1, at=seq(as.Date("2021-06-20"), as.Date("2021-10-30"), "2 weeks"), las=1, font.axis=2, cex.axis=2, format="%d-%b")
for (i in 1:L) polygon(unlist(dat3[[i]]$xx),unlist(dat3[[i]]$yy),col="tomato4", border="black")
for (i in 1:L) polygon(unlist(dat2[[i]]$xx),unlist(dat2[[i]]$yy),col="plum", border="black")
for (i in 1:L) polygon(unlist(dat1[[i]]$xx),unlist(dat1[[i]]$yy),col="turquoise3",border="black")
box(lwd=4)
my.prc
my.data
library("readr")
library("dplyr")
library("ggplot2"); theme_set(theme_bw() +
theme(axis.line = element_line(color='black'),
plot.background = element_blank(),
panel.grid.minor = element_blank(),
panel.grid.major = element_blank()))
library("scales")
library("performance")
library("splines")
library("effects")
library("mgcv")
### To Do:
### 1: Perform tests on PCA to see if different compartments are truly different.
library("corrplot")
library("vegan")
alldata <- data.frame(read_csv("2_incremental/20220420_STANDING_CROP.csv"))
alldata$SAMPLING_DATE<-as.Date(alldata$SAMPLING_DATE, format = "%m/%d/%Y")
names(alldata)
COMPARTMENTS <- alldata[which(alldata$SAMPLE_DESCRIPTOR == "EPIL"| alldata$SAMPLE_DESCRIPTOR == "EPIP" | alldata$SAMPLE_DESCRIPTOR == "FILA"),]
nrow(COMPARTMENTS)
names(COMPARTMENTS)
####Big 5+Fe+Se+Mo####
LABELS<-as.data.frame(na.omit(COMPARTMENTS[,c(3,4,6,13,19,22,25,31,35,40,49)]))
LABELS<-LABELS[order(LABELS$SAMPLE_DESCRIPTOR, decreasing = F), ]
PCA.DF<-as.data.frame(LABELS[,c(4:ncol(LABELS))])
names(PCA.DF)<- c("As","Cd","Cu","Fe","Mo","Pb","Se","Zn")
#dev.new()
cor(PCA.DF)
corrplot(cor(PCA.DF), method = "circle", lwd=2)
###PCA###
PCA.DF<-log(PCA.DF)
my.data <- PCA.DF
my.data <- as.matrix(scale(my.data, center = TRUE, scale = TRUE))
my.prc <- prcomp(na.omit(my.data))
adonis2(groups ~ dis, perm=999)
groups <- factor(LABELS$SAMPLE_DESCRIPTOR)
adonis2(groups ~ my.prc, perm=999)
my.prc
adonis2(groups ~ my.data, perm=999)
adonis2(my.data ~ groups, perm=999)
adonis2(my.data ~ groups, perm=999, method="euclidean")
dis <- vegdist(my.data, method="euclidean")
adonis2(dis ~ groups, perm=999, method="euclidean")
pairwise.adonis2(dis ~ groups, perm=999, method="euclidean")
library("pairwiseAdonis")
install.packages("pairwiseAdonis")
install.packages("RVAideMemoire")
library("RVAideMemoire")
pairwise.perm.manova(dis, groups, nperm = 999, p.method = "fdr", F = FALSE, R2 = FALSE)
plot(my.prc)
pairwise.perm.manova(dis, groups, nperm = 999, p.method = "fdr", F = FALSE, R2 = T)
pairwise.adonis<- pairwise.perm.manova(dis, groups, nperm = 999, p.method = "fdr", F = FALSE, R2 = FALSE)
pairwise.adonis <- pairwise.perm.manova(dis, groups, nperm = 999, p.method = "fdr", F = FALSE, R2 = FALSE)
pairwise.adonis
mod <- betadisper(dis, groups, sqrt.dist=T, bias.adjust=T, type = "centroid")
anova(mod)
names(mod)
permutest(mod, pairwise = TRUE, permutations = 999)
PCA.DF<-log(PCA.DF)
my.data <- PCA.DF
my.data <- as.matrix(scale(my.data, center = TRUE, scale = TRUE))
groups <- factor(LABELS$SAMPLE_DESCRIPTOR)
my.prc <- prcomp(na.omit(my.data))
plot(my.prc)
dis <- vegdist(my.data, method="euclidean")
pairwise.adonis <- pairwise.perm.manova(dis, groups, nperm = 999, p.method = "fdr", F = FALSE, R2 = FALSE)
pairwise.adonis
mod <- betadisper(dis, groups, sqrt.dist=T, bias.adjust=T, type = "centroid")
mod
pairwise.permanova <- pairwise.perm.manova(dis, groups, nperm = 999, p.method = "fdr", F = FALSE, R2 = FALSE)
mod <- betadisper(dis, groups, sqrt.dist=T, bias.adjust=T, type = "centroid")
permutest(mod, pairwise = TRUE, permutations = 999)
pca_scores<-scores(my.prc)
sd <- my.prc$sdev
correlations <- t(t(my.prc$rotation)*sd)
summary(my.prc)
colors <- c(colors()[89], "gold", "chartreuse")
colors <- colors[as.numeric(factor(na.omit(LABELS$SAMPLE_DESCRIPTOR)))]
my.prc$x[,1]<-my.prc$x[,1]*-1
correlations[,1]<-correlations[,1]*-1
plot	(my.prc$x[,1], my.prc$x[,2],
pch=1,
xlim=c(-max(abs(range(my.prc$x[,1]))),max(abs(range(my.prc$x[,1])))),
ylim=c(-max(abs(range(my.prc$x[,2]))),max(abs(range(my.prc$x[,2])))),
cex.lab=1.5, cex.axis=1.5, cex.main=1.4, cex.sub=1.4,
col="white",
xlab="PC 1",
ylab="PC 2"
)
tab <- matrix(c(my.prc$x[,1], my.prc$x[,2]), ncol=2)
legend(x = "topleft", legend = levels(factor(LABELS$SAMPLE_DESCRIPTOR)),
pch=c(23,24,25),
cex = 1,
box.lwd=3,
col = "black",
pt.bg=c(colors()[89], "gold", "chartreuse"), pt.lwd=3)
panel.first= {
ordiellipse(tab,LABELS$SAMPLE_DESCRIPTOR,conf=0.95, draw ="polygon", col=c(adjustcolor(colors()[89], alpha.f=0.25),adjustcolor("gold", alpha.f=0.25),adjustcolor("chartreuse", alpha.f=0.25)), border=c(colors()[89],"gold","chartreuse"), lwd=3)
}
points(my.prc$x[,1],my.prc$x[,2], pch=c(23,24,25)[as.numeric(factor(LABELS$SAMPLE_DESCRIPTOR))],col="black", bg=colors,    cex=1.5,     lwd=2)
par(new=TRUE)
plot	(correlations[1,],
correlations[2,],
col="NA",
xlim=c(-1,1),
ylim=c(-1,1),
xaxt="n",
yaxt="n",
xlab="",
ylab="")
arrows(0, 0,
x1 = correlations[,1],
y1 = correlations[,2],
length = 0.1, angle = 30, lwd =2.0,
code = 2, col = par("fg"),
lty = par("lty"))
text(	x=correlations[,1]*1.075,
y=correlations[,2]*1.05,
labels = names(PCA.DF),
cex=1.5,
font=2)
rownames(my.prc$rotation)
box(lwd=3)
dev.new()
my.prc$x[,1]<-my.prc$x[,1]*-1
correlations[,1]<-correlations[,1]*-1
plot	(my.prc$x[,1], my.prc$x[,2],
pch=1,
xlim=c(-max(abs(range(my.prc$x[,1]))),max(abs(range(my.prc$x[,1])))),
ylim=c(-max(abs(range(my.prc$x[,2]))),max(abs(range(my.prc$x[,2])))),
cex.lab=1.5, cex.axis=1.5, cex.main=1.4, cex.sub=1.4,
col="white",
xlab="PC 1",
ylab="PC 2"
)
tab <- matrix(c(my.prc$x[,1], my.prc$x[,2]), ncol=2)
legend(x = "topleft", legend = levels(factor(LABELS$SAMPLE_DESCRIPTOR)),
pch=c(23,24,25),
cex = 1,
box.lwd=3,
col = "black",
pt.bg=c(colors()[89], "gold", "chartreuse"), pt.lwd=3)
panel.first= {
ordiellipse(tab,LABELS$SAMPLE_DESCRIPTOR,conf=0.95, draw ="polygon", col=c(adjustcolor(colors()[89], alpha.f=0.25),adjustcolor("gold", alpha.f=0.25),adjustcolor("chartreuse", alpha.f=0.25)), border=c(colors()[89],"gold","chartreuse"), lwd=3)
}
points(my.prc$x[,1],my.prc$x[,2], pch=c(23,24,25)[as.numeric(factor(LABELS$SAMPLE_DESCRIPTOR))],col="black", bg=colors,    cex=1.5,     lwd=2)
par(new=TRUE)
plot	(correlations[1,],
correlations[2,],
col="NA",
xlim=c(-1,1),
ylim=c(-1,1),
xaxt="n",
yaxt="n",
xlab="",
ylab="")
arrows(0, 0,
x1 = correlations[,1],
y1 = correlations[,2],
length = 0.1, angle = 30, lwd =2.0,
code = 2, col = par("fg"),
lty = par("lty"))
text(	x=correlations[,1]*1.075,
y=correlations[,2]*1.05,
labels = names(PCA.DF),
cex=1.5,
font=2)
rownames(my.prc$rotation)
box(lwd=3)
coordnames<-data.frame(correlations[,1]*1.1,correlations[,2]*1.1)
coordnames
axis(3, cex.axis=1.5)
mtext("y2",side=4,line=2, col="Blue")
axis(4, cex.axis=1.5)
mtext("y2",side=4,line=2, col="Blue")
abline(h=c(0,0))
abline(v=c(0,0))
my.prc
summary(my.prc)
pca_scores
colors <- c(colors()[89], "gold", "chartreuse")
colors <- colors[as.numeric(factor(na.omit(LABELS$SAMPLE_DESCRIPTOR)))]
plot	(my.prc$x[,1], my.prc$x[,2],
pch=1,
xlim=c(-max(abs(range(my.prc$x[,1]))),max(abs(range(my.prc$x[,1])))),
ylim=c(-max(abs(range(my.prc$x[,2]))),max(abs(range(my.prc$x[,2])))),
cex.lab=1.5, cex.axis=1.5, cex.main=1.4, cex.sub=1.4,
col="white",
xlab="PC 1",
ylab="PC 2"
)
tab <- matrix(c(my.prc$x[,1], my.prc$x[,2]), ncol=2)
legend(x = "topleft", legend = levels(factor(LABELS$SAMPLE_DESCRIPTOR)),
pch=c(23,24,25),
cex = 1,
box.lwd=3,
col = "black",
pt.bg=c(colors()[89], "gold", "chartreuse"), pt.lwd=3)
panel.first= {
ordiellipse(tab,LABELS$SAMPLE_DESCRIPTOR,conf=0.95, draw ="polygon", col=c(adjustcolor(colors()[89], alpha.f=0.25),adjustcolor("gold", alpha.f=0.25),adjustcolor("chartreuse", alpha.f=0.25)), border=c(colors()[89],"gold","chartreuse"), lwd=3)
}
points(my.prc$x[,1],my.prc$x[,2], pch=c(23,24,25)[as.numeric(factor(LABELS$SAMPLE_DESCRIPTOR))],col="black", bg=colors,    cex=1.5,     lwd=2)
par(new=TRUE)
plot	(correlations[1,],
correlations[2,],
col="NA",
xlim=c(-1,1),
ylim=c(-1,1),
xaxt="n",
yaxt="n",
xlab="",
ylab="")
arrows(0, 0,
x1 = correlations[,1],
y1 = correlations[,2],
length = 0.1, angle = 30, lwd =2.0,
code = 2, col = par("fg"),
lty = par("lty"))
text(	x=correlations[,1]*1.075,
y=correlations[,2]*1.05,
labels = names(PCA.DF),
cex=1.5,
font=2)
rownames(my.prc$rotation)
my.prc$x[,1]<-my.prc$x[,1]*-1
correlations[,1]<-correlations[,1]*-1
plot	(my.prc$x[,1], my.prc$x[,2],
pch=1,
xlim=c(-max(abs(range(my.prc$x[,1]))),max(abs(range(my.prc$x[,1])))),
ylim=c(-max(abs(range(my.prc$x[,2]))),max(abs(range(my.prc$x[,2])))),
cex.lab=1.5, cex.axis=1.5, cex.main=1.4, cex.sub=1.4,
col="white",
xlab="PC 1",
ylab="PC 2"
)
tab <- matrix(c(my.prc$x[,1], my.prc$x[,2]), ncol=2)
legend(x = "topleft", legend = levels(factor(LABELS$SAMPLE_DESCRIPTOR)),
pch=c(23,24,25),
cex = 1,
box.lwd=3,
col = "black",
pt.bg=c(colors()[89], "gold", "chartreuse"), pt.lwd=3)
panel.first= {
ordiellipse(tab,LABELS$SAMPLE_DESCRIPTOR,conf=0.95, draw ="polygon", col=c(adjustcolor(colors()[89], alpha.f=0.25),adjustcolor("gold", alpha.f=0.25),adjustcolor("chartreuse", alpha.f=0.25)), border=c(colors()[89],"gold","chartreuse"), lwd=3)
}
points(my.prc$x[,1],my.prc$x[,2], pch=c(23,24,25)[as.numeric(factor(LABELS$SAMPLE_DESCRIPTOR))],col="black", bg=colors,    cex=1.5,     lwd=2)
par(new=TRUE)
plot	(correlations[1,],
correlations[2,],
col="NA",
xlim=c(-1,1),
ylim=c(-1,1),
xaxt="n",
yaxt="n",
xlab="",
ylab="")
arrows(0, 0,
x1 = correlations[,1],
y1 = correlations[,2],
length = 0.1, angle = 30, lwd =2.0,
code = 2, col = par("fg"),
lty = par("lty"))
text(	x=correlations[,1]*1.075,
y=correlations[,2]*1.05,
labels = names(PCA.DF),
cex=1.5,
font=2)
rownames(my.prc$rotation)
box(lwd=3)
text(	x=correlations[,1]*1.075,
y=correlations[,2]*1.05,
labels = names(PCA.DF),
cex=1.0,
font=2)
rownames(my.prc$rotation)
plot	(my.prc$x[,1], my.prc$x[,2],
pch=1,
xlim=c(-max(abs(range(my.prc$x[,1]))),max(abs(range(my.prc$x[,1])))),
ylim=c(-max(abs(range(my.prc$x[,2]))),max(abs(range(my.prc$x[,2])))),
cex.lab=1.5, cex.axis=1.5, cex.main=1.4, cex.sub=1.4,
col="white",
xlab="PC 1",
ylab="PC 2"
)
#	col="black")
tab <- matrix(c(my.prc$x[,1], my.prc$x[,2]), ncol=2)
legend(x = "topleft", legend = levels(factor(LABELS$SAMPLE_DESCRIPTOR)),
pch=c(23,24,25),
cex = 1,
box.lwd=3,
col = "black",
pt.bg=c(colors()[89], "gold", "chartreuse"), pt.lwd=3)
panel.first= {
ordiellipse(tab,LABELS$SAMPLE_DESCRIPTOR,conf=0.95, draw ="polygon", col=c(adjustcolor(colors()[89], alpha.f=0.25),adjustcolor("gold", alpha.f=0.25),adjustcolor("chartreuse", alpha.f=0.25)), border=c(colors()[89],"gold","chartreuse"), lwd=3)
}
points(my.prc$x[,1],my.prc$x[,2], pch=c(23,24,25)[as.numeric(factor(LABELS$SAMPLE_DESCRIPTOR))],col="black", bg=colors,    cex=1.5,     lwd=2)
par(new=TRUE)
plot	(correlations[1,],
correlations[2,],
col="NA",
xlim=c(-1,1),
ylim=c(-1,1),
xaxt="n",
yaxt="n",
xlab="",
ylab="")
arrows(0, 0,
x1 = correlations[,1],
y1 = correlations[,2],
length = 0.1, angle = 30, lwd =2.0,
code = 2, col = par("fg"),
lty = par("lty"))
text(	x=correlations[,1]*1.075,
y=correlations[,2]*1.05,
labels = names(PCA.DF),
cex=1.0,
font=2)
rownames(my.prc$rotation)
box(lwd=3)
pairwise.variance<-permutest(mod, pairwise = TRUE, permutations = 999)
pairwise.variance
pairwise.permanova <- pairwise.perm.manova(dis, groups, nperm = 999, p.method = "fdr", F = FALSE, R2 = FALSE)
pairwise.permanova
#dev.new()
cor(PCA.DF)
corrplot(cor(PCA.DF), method = "circle", lwd=2)
LABELS<-as.data.frame(na.omit(COMPARTMENTS[,c(3,4,6,13,19,22,25,31,35,40,49)]))
LABELS<-LABELS[order(LABELS$SAMPLE_DESCRIPTOR, decreasing = F), ]
PCA.DF<-as.data.frame(LABELS[,c(4:ncol(LABELS))])
names(PCA.DF)<- c("As","Cd","Cu","Fe","Mo","Pb","Se","Zn")
#dev.new()
cor(PCA.DF)
corrplot(cor(PCA.DF), method = "circle", lwd=2)
PCA.DF<-log(PCA.DF)
#dev.new()
cor(PCA.DF)
corrplot(cor(PCA.DF), method = "circle", lwd=2)
PCA.DF<-log(PCA.DF)
LABELS<-as.data.frame(na.omit(COMPARTMENTS[,c(3,4,6,13,19,22,25,31,35,40,49)]))
LABELS<-LABELS[order(LABELS$SAMPLE_DESCRIPTOR, decreasing = F), ]
PCA.DF<-as.data.frame(LABELS[,c(4:ncol(LABELS))])
names(PCA.DF)<- c("As","Cd","Cu","Fe","Mo","Pb","Se","Zn")
#dev.new()
cor(PCA.DF)
corrplot(cor(PCA.DF), method = "circle", lwd=2)
PCA.DF<-log(PCA.DF)
my.data <- PCA.DF
my.data <- as.matrix(scale(my.data, center = TRUE, scale = TRUE))
groups <- factor(LABELS$SAMPLE_DESCRIPTOR)
my.prc <- prcomp(na.omit(my.data))
plot(my.prc)
dis <- vegdist(my.data, method="euclidean")
pairwise.permanova <- pairwise.perm.manova(dis, groups, nperm = 999, p.method = "fdr", F = FALSE, R2 = FALSE)
mod <- betadisper(dis, groups, sqrt.dist=T, bias.adjust=T, type = "centroid")
pairwise.variance<-permutest(mod, pairwise = TRUE, permutations = 999)
pca_scores<-scores(my.prc)
sd <- my.prc$sdev
correlations <- t(t(my.prc$rotation)*sd)
summary(my.prc)
colors <- c(colors()[89], "gold", "chartreuse")
colors <- colors[as.numeric(factor(na.omit(LABELS$SAMPLE_DESCRIPTOR)))]
dev.new()
my.prc$x[,1]<-my.prc$x[,1]*-1
correlations[,1]<-correlations[,1]*-1
plot	(my.prc$x[,1], my.prc$x[,2],
pch=1,
xlim=c(-max(abs(range(my.prc$x[,1]))),max(abs(range(my.prc$x[,1])))),
ylim=c(-max(abs(range(my.prc$x[,2]))),max(abs(range(my.prc$x[,2])))),
cex.lab=1.5, cex.axis=1.5, cex.main=1.4, cex.sub=1.4,
col="white",
xlab="PC 1",
ylab="PC 2"
)
tab <- matrix(c(my.prc$x[,1], my.prc$x[,2]), ncol=2)
legend(x = "topleft", legend = levels(factor(LABELS$SAMPLE_DESCRIPTOR)),
pch=c(23,24,25),
cex = 1,
box.lwd=3,
col = "black",
pt.bg=c(colors()[89], "gold", "chartreuse"), pt.lwd=3)
panel.first= {
ordiellipse(tab,LABELS$SAMPLE_DESCRIPTOR,conf=0.95, draw ="polygon", col=c(adjustcolor(colors()[89], alpha.f=0.25),adjustcolor("gold", alpha.f=0.25),adjustcolor("chartreuse", alpha.f=0.25)), border=c(colors()[89],"gold","chartreuse"), lwd=3)
}
points(my.prc$x[,1],my.prc$x[,2], pch=c(23,24,25)[as.numeric(factor(LABELS$SAMPLE_DESCRIPTOR))],col="black", bg=colors,    cex=1.5,     lwd=2)
par(new=TRUE)
plot	(correlations[1,],
correlations[2,],
col="NA",
xlim=c(-1,1),
ylim=c(-1,1),
xaxt="n",
yaxt="n",
xlab="",
ylab="")
arrows(0, 0,
x1 = correlations[,1],
y1 = correlations[,2],
length = 0.1, angle = 30, lwd =2.0,
code = 2, col = par("fg"),
lty = par("lty"))
text(	x=correlations[,1]*1.075,
y=correlations[,2]*1.05,
labels = names(PCA.DF),
cex=1.0,
font=2)
rownames(my.prc$rotation)
box(lwd=3)
coordnames<-data.frame(correlations[,1]*1.1,correlations[,2]*1.1)
coordnames
axis(3, cex.axis=1.5)
mtext("y2",side=4,line=2, col="Blue")
axis(4, cex.axis=1.5)
mtext("y2",side=4,line=2, col="Blue")
abline(h=c(0,0))
abline(v=c(0,0))
my.prc
dis <- vegdist(my.data, method="euclidean")
mod <- betadisper(dis, groups, sqrt.dist=T, bias.adjust=T, type = "centroid")
pairwise.variance<-permutest(mod, pairwise = TRUE, permutations = 999)
pairwise.variance
