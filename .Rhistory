x= "Cu  (TD, mg/l)",
y= "Cu Content (mg/g)")+
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold"))
p
p=ggplot(data=Cu_DF,aes(F_Cu_NH3,Cu))+
geom_point(aes(color=factor(cat)),size=4)+
geom_smooth(aes(x=F_Cu_NH3, y=Cu, group = factor(cat), color=factor(cat), fill=factor(cat)),
method="glm",
formula = y ~ x,
method.args=list(family="gaussian")) +
labs(title="Title",
x= "Cu  (TD, mg/l)",
y= "Cu Content (mg/g)")+
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold"))
p
Anova(mix.int_Cu_TD)
Fe_DF <- (COMPARTMENTS_AVG[,c("F_Fe_NH3","TURNOVER","Fe")])
Fe_DF$TURNOVER <- asin(sqrt(Fe_DF$TURNOVER ))
quantile(Fe_DF$TURNOVER, probs = seq(0, 1, 1/5))
Fe_DF$cat <- cut(Fe_DF$TURNOVER,
breaks=c(-Inf, 0.2186771    , 0.4699721    , 0.5016606   , 0.5487757, 0.5981569   , Inf),
labels=c("NA", "0.21 - 0.46","0.46 - 0.50","0.50 - 0.54","0.54 - 0.59","0.59 - 0.76"))
Fe_TD <- glm(Fe ~ F_Fe_NH3, data = Fe_DF, family=gaussian)
no.int_Fe_TD  <- glm(Fe ~ (F_Fe_NH3 + TURNOVER), data = Fe_DF, family=gaussian)
mix.int_Fe_TD <- glm(Fe ~ (F_Fe_NH3 * TURNOVER), data = Fe_DF, family=gaussian)
models <- list(Fe_TD, mix.int_Fe_TD, no.int_Fe_TD)
aictab(c(models), modnames=c("Fe_TD","mix.int_Fe_TD","no.int_Fe_TD"), method=ML)
plot(allEffects(mix.int_Fe_TD), lines = list(multiline = T), confint = list(style = "auto"))
plot(allEffects(mix.int_Fe_TD))
Anova(mix.int_Fe_TD)
p=ggplot(data=Fe_DF,aes(F_Fe_NH3,Fe))+
geom_point(aes(color=factor(cat)),size=4)+
geom_smooth(aes(x=F_Fe_NH3, y=Fe, group = factor(cat), color=factor(cat), fill=factor(cat)),
method="glm",
formula = y ~ x,
method.args=list(family="gaussian")) +
labs(title="Title",
x= "Fe  (TD, mg/l)",
y= "Fe Content (mg/g)")+
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold"))
p
Anova(mix.int_Fe_TD)
plot(allEffects(mix.int_Fe_TD))
Mo_DF <- (COMPARTMENTS_AVG[,c("F_Mo_Oshift","TURNOVER","Mo")])
Mo_DF$TURNOVER <- asin(sqrt(Mo_DF$TURNOVER ))
quantile(Mo_DF$TURNOVER, probs = seq(0, 1, 1/5))
Mo_DF$cat <- cut(Mo_DF$TURNOVER,
breaks=c(-Inf, 0.2186771    , 0.4699721    , 0.5016606   , 0.5487757, 0.5981569   , Inf),
labels=c("NA", "0.21 - 0.46","0.46 - 0.50","0.50 - 0.54","0.54 - 0.59","0.59 - 0.76"))
Mo_TD <- glm(Mo ~ F_Mo_Oshift, data = Mo_DF, family=gaussian)
no.int_Mo_TD  <- glm(Mo ~ (F_Mo_Oshift + TURNOVER), data = Mo_DF, family=gaussian)
mix.int_Mo_TD <- glm(Mo ~ (F_Mo_Oshift * TURNOVER), data = Mo_DF, family=gaussian)
models <- list(Mo_TD, mix.int_Mo_TD, no.int_Mo_TD)
aictab(c(models), modnames=c("Mo_TD","mix.int_Mo_TD","no.int_Mo_TD"), method=ML)
plot(allEffects(mix.int_Mo_TD), lines = list(multiline = T), confint = list(style = "auto"))
plot(allEffects(mix.int_Mo_TD))
Anova(mix.int_Mo_TD)
p=ggplot(data=Mo_DF,aes(F_Mo_Oshift,Mo))+
geom_point(aes(color=factor(cat)),size=4)+
geom_smooth(aes(x=F_Mo_Oshift, y=Mo, group = factor(cat), color=factor(cat), fill=factor(cat)),
method="glm",
formula = y ~ x,
method.args=list(family="gaussian")) +
labs(title="Title",
x= "Mo  (TD, mg/l)",
y= "Mo Content (mg/g)")+
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold"))
p
P_DF <- (COMPARTMENTS_AVG[,c("F_P","TURNOVER","P")])
P_DF <- (COMPARTMENTS_AVG[,c("F_P","TURNOVER","P")])
P_DF$TURNOVER <- asin(sqrt(P_DF$TURNOVER ))
quantile(P_DF$TURNOVER, probs = seq(0, 1, 1/5))
P_DF$cat <- cut(P_DF$TURNOVER,
breaks=c(-Inf, 0.2186771    , 0.4699721    , 0.5016606   , 0.5487757, 0.5981569   , Inf),
labels=c("NA", "0.21 - 0.46","0.46 - 0.50","0.50 - 0.54","0.54 - 0.59","0.59 - 0.76"))
P_TD <- glm(P ~ F_P, data = P_DF, family=gaussian)
no.int_P_TD  <- glm(P ~ (F_P + TURNOVER), data = P_DF, family=gaussian)
mix.int_P_TD <- glm(P ~ (F_P * TURNOVER), data = P_DF, family=gaussian)
models <- list(P_TD, mix.int_P_TD, no.int_P_TD)
aictab(c(models), modnames=c("P_TD","mix.int_P_TD","no.int_P_TD"), method=ML)
plot(allEffects(mix.int_P_TD), lines = list(multiline = T), confint = list(style = "auto"))
plot(allEffects(mix.int_P_TD))
Anova(mix.int_P_TD)
p=ggplot(data=P_DF,aes(F_P,P))+
geom_point(aes(color=factor(cat)),size=4)+
geom_smooth(aes(x=F_P, y=P, group = factor(cat), color=factor(cat), fill=factor(cat)),
method="glm",
formula = y ~ x,
method.args=list(family="gaussian")) +
labs(title="Title",
x= "P  (TD, mg/l)",
y= "P Content (mg/g)")+
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold"))
p
Pb_DF <- (COMPARTMENTS_AVG[,c("UF_Pb_NH3","TURNOVER","Pb")])
Pb_DF <- (COMPARTMENTS_AVG[,c("UF_Pb_NH3","TURNOVER","Pb")])
Pb_DF$TURNOVER <- asin(sqrt(Pb_DF$TURNOVER ))
quantile(Pb_DF$TURNOVER, probs = seq(0, 1, 1/5))
Pb_DF$cat <- cut(Pb_DF$TURNOVER,
breaks=c(-Inf, 0.2186771    , 0.4699721    , 0.5016606   , 0.5487757, 0.5981569   , Inf),
labels=c("NA", "0.21 - 0.46","0.46 - 0.50","0.50 - 0.54","0.54 - 0.59","0.59 - 0.76"))
Pb_TD <- glm(Pb ~ UF_Pb_NH3, data = Pb_DF, family=gaussian)
no.int_Pb_TD  <- glm(Pb ~ (UF_Pb_NH3 + TURNOVER), data = Pb_DF, family=gaussian)
mix.int_Pb_TD <- glm(Pb ~ (UF_Pb_NH3 * TURNOVER), data = Pb_DF, family=gaussian)
models <- list(Pb_TD, mix.int_Pb_TD, no.int_Pb_TD)
aictab(c(models), modnames=c("Pb_TD","mix.int_Pb_TD","no.int_Pb_TD"), method=ML)
plot(allEffects(mix.int_Pb_TD), lines = list(multiline = T), confint = list(style = "auto"))
plot(allEffects(mix.int_Pb_TD))
Anova(mix.int_Pb_TD)
p=ggplot(data=Pb_DF,aes(UF_Pb_NH3,Pb))+
geom_point(aes(color=factor(cat)),size=4)+
geom_smooth(aes(x=UF_Pb_NH3, y=Pb, group = factor(cat), color=factor(cat), fill=factor(cat)),
method="glm",
formula = y ~ x,
method.args=list(family="gaussian")) +
labs(title="Title",
x= "Pb  (TD, mg/l)",
y= "Pb Content (mg/g)")+
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold"))
p
pblm<-lm(Pb_DF$Pb ~ Pb_DF$UF_Pb_NH3)
summary(pblm)
with(summary(mix.int_Pb_TD), 1 - deviance/null.deviance)
p
Anova(mix.int_Pb_TD)
plot(allEffects(mix.int_Pb_TD))
Se_DF <- (COMPARTMENTS_AVG[,c("F_Se82_Oshift","TURNOVER","Se")])
Se_DF$TURNOVER <- asin(sqrt(Se_DF$TURNOVER ))
quantile(Se_DF$TURNOVER, probs = seq(0, 1, 1/5))
Se_DF$cat <- cut(Se_DF$TURNOVER,
breaks=c(-Inf, 0.2186771    , 0.4699721    , 0.5016606   , 0.5487757, 0.5981569   , Inf),
labels=c("NA", "0.21 - 0.46","0.46 - 0.50","0.50 - 0.54","0.54 - 0.59","0.59 - 0.76"))
Se_TD <- glm(Se ~ F_Se82_Oshift, data = Se_DF, family=gaussian)
no.int_Se_TD  <- glm(Se ~ (F_Se82_Oshift + TURNOVER), data = Se_DF, family=gaussian)
mix.int_Se_TD <- glm(Se ~ (F_Se82_Oshift * TURNOVER), data = Se_DF, family=gaussian)
models <- list(Se_TD, mix.int_Se_TD, no.int_Se_TD)
aictab(c(models), modnames=c("Se_TD","mix.int_Se_TD","no.int_Se_TD"), method=ML)
plot(allEffects(mix.int_Se_TD), lines = list(multiline = T), confint = list(style = "auto"))
plot(allEffects(mix.int_Se_TD))
Anova(mix.int_Se_TD)
Anova(mix.int_Se_TD)
plot(allEffects(mix.int_Se_TD))
p=ggplot(data=Se_DF,aes(F_Se82_Oshift,Se))+
geom_point(aes(color=factor(cat)),size=4)+
geom_smooth(aes(x=F_Se82_Oshift, y=Se, group = factor(cat), color=factor(cat), fill=factor(cat)),
method="glm",
formula = y ~ x,
method.args=list(family="gaussian")) +
labs(title="Title",
x= "Se  (TD, mg/l)",
y= "Se Content (mg/g)")+
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold"))
p
Zn_DF <- (COMPARTMENTS_AVG[,c("F_Zn","TURNOVER","Zn")])
Zn_DF$TURNOVER <- asin(sqrt(Zn_DF$TURNOVER ))
quantile(Zn_DF$TURNOVER, probs = seq(0, 1, 1/5))
Zn_DF$cat <- cut(Zn_DF$TURNOVER,
breaks=c(-Inf, 0.2186771    , 0.4699721    , 0.5016606   , 0.5487757, 0.5981569   , Inf),
labels=c("NA", "0.21 - 0.46","0.46 - 0.50","0.50 - 0.54","0.54 - 0.59","0.59 - 0.76"))
Zn_TD <- glm(Zn ~ F_Zn, data = Zn_DF, family=gaussian)
no.int_Zn_TD  <- glm(Zn ~ (F_Zn + TURNOVER), data = Zn_DF, family=gaussian)
mix.int_Zn_TD <- glm(Zn ~ (F_Zn * TURNOVER), data = Zn_DF, family=gaussian)
models <- list(Zn_TD, mix.int_Zn_TD, no.int_Zn_TD)
aictab(c(models), modnames=c("Zn_TD","mix.int_Zn_TD","no.int_Zn_TD"), method=ML)
plot(allEffects(mix.int_Zn_TD), lines = list(multiline = T), confint = list(style = "auto"))
plot(allEffects(mix.int_Zn_TD))
Anova(mix.int_Zn_TD)
p=ggplot(data=Zn_DF,aes(F_Zn,Zn))+
geom_point(aes(color=factor(cat)),size=4)+
geom_smooth(aes(x=F_Zn, y=Zn, group = factor(cat), color=factor(cat), fill=factor(cat)),
method="glm",
formula = y ~ x,
method.args=list(family="gaussian")) +
labs(title="Title",
x= "Zn  (TD, mg/l)",
y= "Zn Content (mg/g)")+
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold"))
p
Cd_DF <- (COMPARTMENTS_AVG[,c("F_Cd114","TURNOVER","Cd")])
Cd_DF$TURNOVER <- asin(sqrt(Cd_DF$TURNOVER ))
quantile(Cd_DF$TURNOVER, probs = seq(0, 1, 1/5))
Cd_DF$cat <- cut(Cd_DF$TURNOVER,
breaks=c(-Inf, 0.2186771    , 0.4699721    , 0.5016606   , 0.5487757, 0.5981569   , Inf),
labels=c("NA", "0.21 - 0.46","0.46 - 0.50","0.50 - 0.54","0.54 - 0.59","0.59 - 0.76"))
Cd_TD <- glm(Cd ~ F_Cd114, data = Cd_DF, family=gaussian)
no.int_Cd_TD  <- glm(Cd ~ (F_Cd114 + TURNOVER), data = Cd_DF, family=gaussian)
mix.int_Cd_TD <- glm(Cd ~ (F_Cd114 * TURNOVER), data = Cd_DF, family=gaussian)
models <- list(Cd_TD, mix.int_Cd_TD, no.int_Cd_TD)
aictab(c(models), modnames=c("Cd_TD","mix.int_Cd_TD","no.int_Cd_TD"), method=ML)
plot(allEffects(mix.int_Cd_TD), lines = list(multiline = T), confint = list(style = "auto"))
plot(allEffects(mix.int_Cd_TD))
set.seed(666)
dataset <- expand.grid(Temp = rnorm(30), Age = runif(10))
set.seed(666)
dataset <- expand.grid(Temp = rnorm(30), Age = runif(10))
dataset
dataset$Truth <- with(dataset, plogis(2 * Temp - 3 * Age))
dataset
dataset$Sample <- rbinom(nrow(dataset), size = 1, prob = dataset$Truth)
dataset
model <- glm(Sample ~ Temp + Age, data = dataset, family = binomial)
newdata <- expand.grid(
Temp = pretty(dataset$Temp, 20),
Age = pretty(dataset$Age, 5))
newdata$Sample <- predict(model, newdata = newdata, type = "response")
newdata
ggplot(newdata, aes(x = Temp, y = Sample)) + geom_line() + facet_wrap(~Age)
ggplot(newdata, aes(x = Temp, y = Sample, colour = Age, group = Age)) +
geom_line()
plot(allEffects(mix.int_As_TD), lines = list(multiline = T), confint = list(style = "auto"))
with(summary(mix.int_As_TD), 1 - deviance/null.deviance)
p=ggplot(data=As_DF,aes(F_As_Oshift,As))+
geom_point(aes(color=factor(cat)),size=4)+
geom_smooth(aes(x=F_As_Oshift, y=As, group = factor(cat), color=factor(cat), fill=factor(cat)),
method="glm",
formula = y ~ x,
method.args=list(family="gaussian")) +
labs(title="Title",
x= "As  (TD, mg/l)",
y= "As Content (mg/g)")+
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold"))
p
with(summary(mix.int_Cd_TD), 1 - deviance/null.deviance)
with(summary(mix.int_Cu_TD), 1 - deviance/null.deviance)
with(summary(mix.int_Fe_TD), 1 - deviance/null.deviance)
with(summary(mix.int_Mo_TD), 1 - deviance/null.deviance)
with(summary(mix.int_P_TD), 1 - deviance/null.deviance)
with(summary(mix.int_Pb_TD), 1 - deviance/null.deviance)
with(summary(mix.int_Pb_TD), 1 - deviance/null.deviance)
with(summary(mix.int_Se_TD), 1 - deviance/null.deviance)
with(summary(mix.int_Zn_TD), 1 - deviance/null.deviance)
library(readr)
library(effects)
library(AICcmodavg)
library(nlme)
library(car)
library(interactions)
library("ggplot2"); theme_set(theme_bw() +
theme(axis.line = element_line(color='black'),
plot.background = element_blank(),
panel.grid.minor = element_blank(),
panel.grid.major = element_blank()))
library(lme4)
COMPARTMENTS_AVG <- data.frame(read.csv("2_incremental/TURNOVER_Full_Dataset_AVG.csv"))
COMPARTMENTS_AVG$SAMPLE_DESCRIPTOR <-as.factor(COMPARTMENTS_AVG$SAMPLE_DESCRIPTOR)
#COMPARTMENTS_AVG <- COMPARTMENTS_AVG[which(COMPARTMENTS_AVG$SAMPLE_DESCRIPTOR == "EPIL"| COMPARTMENTS_AVG$SAMPLE_DESCRIPTOR == "EPIP"),]
#COMPARTMENTS_AVG <- COMPARTMENTS_AVG[which(COMPARTMENTS_AVG$SAMPLE_DESCRIPTOR == "FILA"),]
#### GLMs####
#COMPARTMENTS_AVG['SAMPLE_DESCRIPTOR'][COMPARTMENTS_AVG['SAMPLE_DESCRIPTOR'] == 'EPIP'] <- 'EPIL'
names(COMPARTMENTS_AVG)
COMPARTMENTS_AVG$SITE <- as.factor(COMPARTMENTS_AVG$SITE)
#dev.new()
### As ###
As_DF <- (COMPARTMENTS_AVG[,c("F_As_Oshift","TURNOVER","As")])
As_DF <- (COMPARTMENTS_AVG[,c("F_As_Oshift","TURNOVER","As")])
As_DF <- As_DF[complete.cases(As_DF), ]
As_DF$TURNOVER <- asin(sqrt(As_DF$TURNOVER ))
quantile(As_DF$TURNOVER, probs = seq(0, 1, 1/5))
As_DF$cat <- cut(As_DF$TURNOVER,
breaks=c(-Inf, 0.2186771    , 0.4699721    , 0.5016606   , 0.5487757, 0.5981569   , Inf),
labels=c("NA", "0.21 - 0.46","0.46 - 0.50","0.50 - 0.54","0.54 - 0.59","0.59 - 0.76"))
As_TD <- glm(As ~ F_As_Oshift, data = As_DF, family=gaussian)
no.int_As_TD  <- glm(As ~ (F_As_Oshift + TURNOVER), data = As_DF, family=gaussian)
mix.int_As_TD <- glm(As ~ (F_As_Oshift * TURNOVER), data = As_DF, family=gaussian)
models <- list(As_TD, mix.int_As_TD, no.int_As_TD)
aictab(c(models), modnames=c("As_TD","mix.int_As_TD","no.int_As_TD"), method=ML)
plot(allEffects(mix.int_As_TD), lines = list(multiline = T), confint = list(style = "auto"))
plot(allEffects(mix.int_As_TD))
Anova(mix.int_As_TD)
with(summary(mix.int_As_TD), 1 - deviance/null.deviance)
### PLOT ###
p=ggplot(data=As_DF,aes(F_As_Oshift,As))+
geom_point(aes(color=factor(cat)),size=4)+
geom_smooth(aes(x=F_As_Oshift, y=As, group = factor(cat), color=factor(cat), fill=factor(cat)),
method="glm",
formula = y ~ x,
method.args=list(family="gaussian")) +
labs(title="Title",
x= "As  (TD, mg/l)",
y= "As Content (mg/g)")+
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold"))
p
### Cd ###
Cd_DF <- (COMPARTMENTS_AVG[,c("F_Cd114","TURNOVER","Cd")])
Cd_DF$TURNOVER <- asin(sqrt(Cd_DF$TURNOVER ))
quantile(Cd_DF$TURNOVER, probs = seq(0, 1, 1/5))
COMPARTMENTS_AVG <- data.frame(read.csv("2_incremental/TURNOVER_Full_Dataset_AVG.csv"))
COMPARTMENTS_AVG$SAMPLE_DESCRIPTOR <-as.factor(COMPARTMENTS_AVG$SAMPLE_DESCRIPTOR)
names(COMPARTMENTS_AVG)
COMPARTMENTS_AVG$SITE <- as.factor(COMPARTMENTS_AVG$SITE)
As_DF <- (COMPARTMENTS_AVG[,c("F_As_Oshift","TURNOVER","As")])
As_DF <- (COMPARTMENTS_AVG[,c("F_As_Oshift","TURNOVER","As")])
As_DF <- As_DF[complete.cases(As_DF), ]
As_DF$TURNOVER <- asin(sqrt(As_DF$TURNOVER ))
quantile(As_DF$TURNOVER, probs = seq(0, 1, 1/5))
As_DF$cat <- cut(As_DF$TURNOVER,
breaks=c(-Inf, 0.2186771    , 0.4699721    , 0.5016606   , 0.5487757, 0.5981569   , Inf),
labels=c("NA", "0.21 - 0.46","0.46 - 0.50","0.50 - 0.54","0.54 - 0.59","0.59 - 0.76"))
As_DF$cat <- cut(As_DF$TURNOVER,
breaks=c(-Inf, 0.2930134     , 0.4377104     , 0.5062439    , 0.5789544 , 0.7672459    , Inf),
labels=c("NA", "0.21 - 0.46","0.46 - 0.50","0.50 - 0.54","0.54 - 0.59","0.59 - 0.76"))
As_TD <- glm(As ~ F_As_Oshift, data = As_DF, family=gaussian)
no.int_As_TD  <- glm(As ~ (F_As_Oshift + TURNOVER), data = As_DF, family=gaussian)
mix.int_As_TD <- glm(As ~ (F_As_Oshift * TURNOVER), data = As_DF, family=gaussian)
models <- list(As_TD, mix.int_As_TD, no.int_As_TD)
aictab(c(models), modnames=c("As_TD","mix.int_As_TD","no.int_As_TD"), method=ML)
plot(allEffects(mix.int_As_TD), lines = list(multiline = T), confint = list(style = "auto"))
plot(allEffects(mix.int_As_TD))
Anova(mix.int_As_TD)
with(summary(mix.int_As_TD), 1 - deviance/null.deviance)
p=ggplot(data=As_DF,aes(F_As_Oshift,As))+
geom_point(aes(color=factor(cat)),size=4)+
geom_smooth(aes(x=F_As_Oshift, y=As, group = factor(cat), color=factor(cat), fill=factor(cat)),
method="glm",
formula = y ~ x,
method.args=list(family="gaussian")) +
labs(title="Title",
x= "As  (TD, mg/l)",
y= "As Content (mg/g)")+
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold"))
p
Anova(mix.int_As_TD)
As_DF
quantile(As_DF$TURNOVER, probs = seq(0, 1, 1/5))
quantile(As_DF$TURNOVER, probs = seq(0, 1, 1/7))
library(readr)
library(effects)
library(AICcmodavg)
library(nlme)
library(car)
library(interactions)
library("ggplot2"); theme_set(theme_bw() +
theme(axis.line = element_line(color='black'),
plot.background = element_blank(),
panel.grid.minor = element_blank(),
panel.grid.major = element_blank()))
library(lme4)
COMPARTMENTS_AVG <- data.frame(read.csv("2_incremental/TURNOVER_Full_Dataset_AVG.csv"))
COMPARTMENTS_AVG$SAMPLE_DESCRIPTOR <-as.factor(COMPARTMENTS_AVG$SAMPLE_DESCRIPTOR)
#COMPARTMENTS_AVG <- COMPARTMENTS_AVG[which(COMPARTMENTS_AVG$SAMPLE_DESCRIPTOR == "EPIL"| COMPARTMENTS_AVG$SAMPLE_DESCRIPTOR == "EPIP"),]
#COMPARTMENTS_AVG <- COMPARTMENTS_AVG[which(COMPARTMENTS_AVG$SAMPLE_DESCRIPTOR == "FILA"),]
#### GLMs####
#COMPARTMENTS_AVG['SAMPLE_DESCRIPTOR'][COMPARTMENTS_AVG['SAMPLE_DESCRIPTOR'] == 'EPIP'] <- 'EPIL'
names(COMPARTMENTS_AVG)
COMPARTMENTS_AVG$SITE <- as.factor(COMPARTMENTS_AVG$SITE)
#dev.new()
### As ###
As_DF <- (COMPARTMENTS_AVG[,c("F_As_Oshift","TURNOVER","As")])
As_DF <- As_DF[complete.cases(As_DF), ]
As_DF$TURNOVER <- asin(sqrt(As_DF$TURNOVER ))
quantile(As_DF$TURNOVER, probs = seq(0, 1, 1/7))
As_DF$cat <- cut(As_DF$TURNOVER,
breaks=c(-Inf, 0.1790476, 0.2667151, 0.3587456, 0.4575136, 0.5016607, 0.5418384, 0.5981569, Inf),
labels=c("NA", "0.17 - 0.26","0.26 - 0.35","0.35 - 0.45","0.45 - 0.50","0.50 - 0.54", "0.54 - 0.59",  "0.59 - 0.76"))
As_DF
As_DF$cat <- cut(As_DF$TURNOVER,
breaks=c(-Inf, 0.1790476, 0.2667151, 0.3587456, 0.4575136, 0.5016607, 0.5418384, 0.5981569, Inf),
labels=c("0.17 - 0.26","0.26 - 0.35","0.35 - 0.45","0.45 - 0.50","0.50 - 0.54", "0.54 - 0.59",  "0.59 - 0.76"))
quantile(As_DF$TURNOVER, probs = seq(0, 1, 1/7))
As_DF$cat <- cut(As_DF$TURNOVER,
breaks=c(0.1790476, 0.2667151, 0.3587456, 0.4575136, 0.5016607, 0.5418384, 0.5981569, Inf),
labels=c("0.17 - 0.26","0.26 - 0.35","0.35 - 0.45","0.45 - 0.50","0.50 - 0.54", "0.54 - 0.59",  "0.59 - 0.76"))
As_TD <- glm(As ~ F_As_Oshift, data = As_DF, family=gaussian)
no.int_As_TD  <- glm(As ~ (F_As_Oshift + TURNOVER), data = As_DF, family=gaussian)
mix.int_As_TD <- glm(As ~ (F_As_Oshift * TURNOVER), data = As_DF, family=gaussian)
models <- list(As_TD, mix.int_As_TD, no.int_As_TD)
aictab(c(models), modnames=c("As_TD","mix.int_As_TD","no.int_As_TD"), method=ML)
plot(allEffects(mix.int_As_TD), lines = list(multiline = T), confint = list(style = "auto"))
plot(allEffects(mix.int_As_TD))
Anova(mix.int_As_TD)
with(summary(mix.int_As_TD), 1 - deviance/null.deviance)
p=ggplot(data=As_DF,aes(F_As_Oshift,As))+
geom_point(aes(color=factor(cat)),size=4)+
geom_smooth(aes(x=F_As_Oshift, y=As, group = factor(cat), color=factor(cat), fill=factor(cat)),
method="glm",
formula = y ~ x,
method.args=list(family="gaussian")) +
labs(title="Title",
x= "As  (TD, mg/l)",
y= "As Content (mg/g)")+
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold"))
p
quantile(As_DF$TURNOVER, probs = seq(0, 1, 1/7))
As_DF$cat <- cut(As_DF$TURNOVER,
breaks=c(0.1790476, 0.2667151, 0.3587456, 0.4575136, 0.5016607, 0.5418384, 0.5981569, 0.7672459 ),
labels=c("0.17 - 0.26","0.26 - 0.35","0.35 - 0.45","0.45 - 0.50","0.50 - 0.54", "0.54 - 0.59",  "0.59 - 0.76"))
As_TD <- glm(As ~ F_As_Oshift, data = As_DF, family=gaussian)
no.int_As_TD  <- glm(As ~ (F_As_Oshift + TURNOVER), data = As_DF, family=gaussian)
mix.int_As_TD <- glm(As ~ (F_As_Oshift * TURNOVER), data = As_DF, family=gaussian)
models <- list(As_TD, mix.int_As_TD, no.int_As_TD)
aictab(c(models), modnames=c("As_TD","mix.int_As_TD","no.int_As_TD"), method=ML)
plot(allEffects(mix.int_As_TD), lines = list(multiline = T), confint = list(style = "auto"))
plot(allEffects(mix.int_As_TD))
Anova(mix.int_As_TD)
with(summary(mix.int_As_TD), 1 - deviance/null.deviance)
p=ggplot(data=As_DF,aes(F_As_Oshift,As))+
geom_point(aes(color=factor(cat)),size=4)+
geom_smooth(aes(x=F_As_Oshift, y=As, group = factor(cat), color=factor(cat), fill=factor(cat)),
method="glm",
formula = y ~ x,
method.args=list(family="gaussian")) +
labs(title="Title",
x= "As  (TD, mg/l)",
y= "As Content (mg/g)")+
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold"))
p
Cd_DF <- (COMPARTMENTS_AVG[,c("F_Cd114","TURNOVER","Cd")])
Cd_DF <- (COMPARTMENTS_AVG[,c("F_Cd114","TURNOVER","Cd")])
Cd_DF$TURNOVER <- asin(sqrt(Cd_DF$TURNOVER ))
quantile(Cd_DF$TURNOVER, probs = seq(0, 1, 1/5))
Cd_DF$cat <- cut(Cd_DF$TURNOVER,
breaks=c(0.1790476, 0.2667151, 0.3587456, 0.4575136, 0.5016607, 0.5418384, 0.5981569, 0.7672459 ),
labels=c("0.17 - 0.26","0.26 - 0.35","0.35 - 0.45","0.45 - 0.50","0.50 - 0.54", "0.54 - 0.59",  "0.59 - 0.76"))
Cd_TD <- glm(Cd ~ F_Cd114, data = Cd_DF, family=gaussian)
no.int_Cd_TD  <- glm(Cd ~ (F_Cd114 + TURNOVER), data = Cd_DF, family=gaussian)
mix.int_Cd_TD <- glm(Cd ~ (F_Cd114 * TURNOVER), data = Cd_DF, family=gaussian)
models <- list(Cd_TD, mix.int_Cd_TD, no.int_Cd_TD)
aictab(c(models), modnames=c("Cd_TD","mix.int_Cd_TD","no.int_Cd_TD"), method=ML)
Cd_DF <- (COMPARTMENTS_AVG[,c("F_Cd114","TURNOVER","Cd")])
Cd_DF <- Cd_DF[complete.cases(Cd_DF), ]
Cd_DF$TURNOVER <- asin(sqrt(Cd_DF$TURNOVER ))
quantile(Cd_DF$TURNOVER, probs = seq(0, 1, 1/5))
Cd_DF$cat <- cut(Cd_DF$TURNOVER,
breaks=c(0.1790476, 0.2667151, 0.3587456, 0.4575136, 0.5016607, 0.5418384, 0.5981569, 0.7672459 ),
labels=c("0.17 - 0.26","0.26 - 0.35","0.35 - 0.45","0.45 - 0.50","0.50 - 0.54", "0.54 - 0.59",  "0.59 - 0.76"))
Cd_TD <- glm(Cd ~ F_Cd114, data = Cd_DF, family=gaussian)
no.int_Cd_TD  <- glm(Cd ~ (F_Cd114 + TURNOVER), data = Cd_DF, family=gaussian)
mix.int_Cd_TD <- glm(Cd ~ (F_Cd114 * TURNOVER), data = Cd_DF, family=gaussian)
models <- list(Cd_TD, mix.int_Cd_TD, no.int_Cd_TD)
aictab(c(models), modnames=c("Cd_TD","mix.int_Cd_TD","no.int_Cd_TD"), method=ML)
plot(allEffects(mix.int_Cd_TD), lines = list(multiline = T), confint = list(style = "auto"))
plot(allEffects(mix.int_Cd_TD))
Anova(mix.int_Cd_TD)
with(summary(mix.int_Cd_TD), 1 - deviance/null.deviance)
p=ggplot(data=Cd_DF,aes(F_Cd114,Cd))+
geom_point(aes(color=factor(cat)),size=4)+
geom_smooth(aes(x=F_Cd114, y=Cd, group = factor(cat), color=factor(cat), fill=factor(cat)),
method="glm",
formula = y ~ x,
method.args=list(family="gaussian")) +
labs(title="Title",
x= "Cd  (TD, mg/l)",
y= "Cd Content (mg/g)")+
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold"))
p
quantile(Cd_DF$TURNOVER, probs = seq(0, 1, 1/5))
Cd_DF$cat <- cut(Cd_DF$TURNOVER,
breaks=c(0.16, 0.2667151, 0.3587456, 0.4575136, 0.5016607, 0.5418384, 0.5981569, 0.77 ),
labels=c("0.17 - 0.26","0.26 - 0.35","0.35 - 0.45","0.45 - 0.50","0.50 - 0.54", "0.54 - 0.59",  "0.59 - 0.76"))
Cd_TD <- glm(Cd ~ F_Cd114, data = Cd_DF, family=gaussian)
no.int_Cd_TD  <- glm(Cd ~ (F_Cd114 + TURNOVER), data = Cd_DF, family=gaussian)
mix.int_Cd_TD <- glm(Cd ~ (F_Cd114 * TURNOVER), data = Cd_DF, family=gaussian)
models <- list(Cd_TD, mix.int_Cd_TD, no.int_Cd_TD)
aictab(c(models), modnames=c("Cd_TD","mix.int_Cd_TD","no.int_Cd_TD"), method=ML)
plot(allEffects(mix.int_Cd_TD), lines = list(multiline = T), confint = list(style = "auto"))
plot(allEffects(mix.int_Cd_TD))
Anova(mix.int_Cd_TD)
with(summary(mix.int_Cd_TD), 1 - deviance/null.deviance)
p=ggplot(data=Cd_DF,aes(F_Cd114,Cd))+
geom_point(aes(color=factor(cat)),size=4)+
geom_smooth(aes(x=F_Cd114, y=Cd, group = factor(cat), color=factor(cat), fill=factor(cat)),
method="glm",
formula = y ~ x,
method.args=list(family="gaussian")) +
labs(title="Title",
x= "Cd  (TD, mg/l)",
y= "Cd Content (mg/g)")+
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold"))
p
As_DF <- (COMPARTMENTS_AVG[,c("F_As_Oshift","TURNOVER","As")])
As_DF <- As_DF[complete.cases(As_DF), ]
As_DF$TURNOVER <- asin(sqrt(As_DF$TURNOVER ))
quantile(As_DF$TURNOVER, probs = seq(0, 1, 1/7))
As_DF$cat <- cut(As_DF$TURNOVER,
breaks=c(0.16, 0.2667151, 0.3587456, 0.4575136, 0.5016607, 0.5418384, 0.5981569, 0.77 ),
labels=c("0.17 - 0.26","0.26 - 0.35","0.35 - 0.45","0.45 - 0.50","0.50 - 0.54", "0.54 - 0.59",  "0.59 - 0.76"))
As_TD <- glm(As ~ F_As_Oshift, data = As_DF, family=gaussian)
no.int_As_TD  <- glm(As ~ (F_As_Oshift + TURNOVER), data = As_DF, family=gaussian)
mix.int_As_TD <- glm(As ~ (F_As_Oshift * TURNOVER), data = As_DF, family=gaussian)
models <- list(As_TD, mix.int_As_TD, no.int_As_TD)
aictab(c(models), modnames=c("As_TD","mix.int_As_TD","no.int_As_TD"), method=ML)
plot(allEffects(mix.int_As_TD), lines = list(multiline = T), confint = list(style = "auto"))
plot(allEffects(mix.int_As_TD))
Anova(mix.int_As_TD)
with(summary(mix.int_As_TD), 1 - deviance/null.deviance)
p=ggplot(data=As_DF,aes(F_As_Oshift,As))+
geom_point(aes(color=factor(cat)),size=4)+
geom_smooth(aes(x=F_As_Oshift, y=As, group = factor(cat), color=factor(cat), fill=factor(cat)),
method="glm",
formula = y ~ x,
method.args=list(family="gaussian")) +
labs(title="Title",
x= "As  (TD, mg/l)",
y= "As Content (mg/g)")+
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold"))
p
